<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 3.7.2"/><script>/**
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚îÄ‚îÄ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà
‚îÄ‚îÄ‚îÄ‚îÄ‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñà‚ñà
‚îÄ‚îÄ‚îÄ‚îÄ‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà              MAMMA MIA!
‚îÄ‚îÄ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñë‚ñë‚ñà‚ñà‚ñë‚ñë‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà
‚îÄ‚îÄ‚ñà‚ñà‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñë‚ñë‚ñà‚ñà‚ñë‚ñë‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà   If you are looking here you
‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà      should definitely get
‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà       in touch with me on
‚îÄ‚îÄ‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà           twitter: @loige
‚îÄ‚îÄ‚îÄ‚îÄ‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà
‚îÄ‚îÄ‚îÄ‚îÄ‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà
‚îÄ‚îÄ‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚îÄ‚îÄ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚îÄ‚îÄ‚îÄ‚îÄ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà
‚îÄ‚îÄ‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà
‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà
‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚îÄ‚îÄ‚ñà‚ñà‚ñà‚ñà
**/</script><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="alternate" type="application/rss+xml" title="Luciano Mammino &quot;Loige&quot; - FullStack &amp; Cloud developer, fighter, butterfly maker!" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=e5514a6b277bf3f1409d8b0190e93509" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#20232a"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=e5514a6b277bf3f1409d8b0190e93509"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=e5514a6b277bf3f1409d8b0190e93509"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=e5514a6b277bf3f1409d8b0190e93509"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=e5514a6b277bf3f1409d8b0190e93509"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=e5514a6b277bf3f1409d8b0190e93509"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=e5514a6b277bf3f1409d8b0190e93509"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=e5514a6b277bf3f1409d8b0190e93509"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=e5514a6b277bf3f1409d8b0190e93509"/><title data-react-helmet="true">Invite-only microsites with Next.js and AirTable</title><link data-react-helmet="true" type="text/plain" rel="author" href="https://loige.co/humans.txt"/><link data-react-helmet="true" rel="canonical" content="https://loige.co/invite-only-microsites-with-nextjs-and-airtable/"/><meta data-react-helmet="true" name="description" content="A tutorial on how to build invite-only micro-sites cheaply and quickly using Next.js (on Vercel) and Airtable as a mini database"/><meta data-react-helmet="true" name="image" content="https://loige.co/static/a86aea86f43d71abeca0f9afc7f44afd/invite-only-microsites-with-nextjs-and-airtable-fb.png"/><meta data-react-helmet="true" property="og:url" content="https://loige.co/invite-only-microsites-with-nextjs-and-airtable/"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="Invite-only microsites with Next.js and AirTable"/><meta data-react-helmet="true" property="og:description" content="A tutorial on how to build invite-only micro-sites cheaply and quickly using Next.js (on Vercel) and Airtable as a mini database"/><meta data-react-helmet="true" property="og:image" content="https://loige.co/static/a86aea86f43d71abeca0f9afc7f44afd/invite-only-microsites-with-nextjs-and-airtable-fb.png"/><meta data-react-helmet="true" property="fb:app_id" content="231187154413670"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content="loige"/><meta data-react-helmet="true" name="twitter:title" content="Invite-only microsites with Next.js and AirTable"/><meta data-react-helmet="true" name="twitter:description" content="A tutorial on how to build invite-only micro-sites cheaply and quickly using Next.js (on Vercel) and Airtable as a mini database"/><meta data-react-helmet="true" name="twitter:image" content="https://loige.co/static/cb956e151dccf6640e09a7a8aea91f23/invite-only-microsites-with-nextjs-and-airtable-tw.png"/><script data-react-helmet="true" type="application/ld+json">[{"@context":"http://schema.org","@type":"WebSite","url":"https://loige.co/invite-only-microsites-with-nextjs-and-airtable/","name":"Invite-only microsites with Next.js and AirTable","alternateName":"Luciano Mammino \"Loige\" - FullStack & Cloud developer, fighter, butterfly maker!"},{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://loige.co/invite-only-microsites-with-nextjs-and-airtable/","name":"Invite-only microsites with Next.js and AirTable","image":"https://loige.co/static/a86aea86f43d71abeca0f9afc7f44afd/invite-only-microsites-with-nextjs-and-airtable-fb.png"}}]},{"@context":"http://schema.org","@type":"BlogPosting","url":"https://loige.co/invite-only-microsites-with-nextjs-and-airtable/","name":"Invite-only microsites with Next.js and AirTable","alternateName":"Luciano Mammino \"Loige\" - FullStack & Cloud developer, fighter, butterfly maker!","headline":"Invite-only microsites with Next.js and AirTable","image":{"@type":"ImageObject","url":"https://loige.co/static/a86aea86f43d71abeca0f9afc7f44afd/invite-only-microsites-with-nextjs-and-airtable-fb.png"},"description":"A tutorial on how to build invite-only micro-sites cheaply and quickly using Next.js (on Vercel) and Airtable as a mini database","author":{"@type":"Person","name":"Luciano Mammino"},"publisher":{"@type":"Organization","url":"https://loige.co/","name":"Luciano Mammino","logo":{"@context":"http://schema.org","itemtype":"https://schema.org/ImageObject","url":"https://loige.co/favicon.ico"}},"mainEntityOfPage":{"@type":"WebSite","@id":"https://loige.co/"},"datePublished":"2022-08-09T07:40:00.000Z"}]</script><link as="script" rel="preload" href="/webpack-runtime-37ce8688ee417142fe08.js"/><link as="script" rel="preload" href="/framework-9d9eff57288a5d76d992.js"/><link as="script" rel="preload" href="/app-514e309b4e51a67a0ada.js"/><link as="script" rel="preload" href="/ab670281d767243777119348a2b810446e7309bb-19b089964506eaf24367.js"/><link as="script" rel="preload" href="/850935577dc6138b95e5bc3f6f1d9b06bd36398e-b459adf742dcd4c51b3c.js"/><link as="script" rel="preload" href="/4d6423837748823c19bdd3076c1db680baba727b-30a9131768be883bb7a1.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-37356b1e59c3cfadffb9.js"/><link as="fetch" rel="preload" href="/page-data/invite-only-microsites-with-nextjs-and-airtable/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><style data-emotion="css-global xqze0f">*{box-sizing:border-box;margin:0;padding:0;}body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-style:normal;font-weight:400;fill:currentColor;}@media (min-width: 780px){body{margin:60px 0 0 0;}}code,pre{font-family:source-code-pro,Menlo,Monaco,Consolas,Courier New,monospace;font-weight:300;}.content a{-webkit-text-decoration:none;text-decoration:none;}blockquote .gatsby-highlight{margin:1.5em 0 1.5em 0;padding:0.5em;}.gatsby-highlight{font-size:15px;line-height:1.7;background:#282c34;color:#ffffff;border-radius:10px;overflow:auto;tab-size:1.5em;margin:1.5em -1em 1.5em 0;padding:1em;}@media (min-width: 780px){.gatsby-highlight{margin-left:-2em;padding-left:2em;padding-right:2em;font-size:16px;}}.gatsby-highlight .token.attr-name{color:#c5a5c5;}.gatsby-highlight .token.comment,.gatsby-highlight .token.block-comment,.gatsby-highlight .token.prolog,.gatsby-highlight .token.doctype,.gatsby-highlight .token.cdata{color:#999999;}.gatsby-highlight .token.property,.gatsby-highlight .token.number,.gatsby-highlight .token.function-name,.gatsby-highlight .token.constant,.gatsby-highlight .token.symbol,.gatsby-highlight .token.deleted{color:#5a9bcf;}.gatsby-highlight .token.boolean{color:#ff8b50;}.gatsby-highlight .token.tag{color:#fc929e;}.gatsby-highlight .token.string{color:#8dc891;}.gatsby-highlight .token.punctuation{color:#5FB3B3;}.gatsby-highlight .token.selector,.gatsby-highlight .token.char,.gatsby-highlight .token.builtin,.gatsby-highlight .token.inserted{color:#D8DEE9;}.gatsby-highlight .token.function{color:#79b6f2;}.gatsby-highlight .token.operator,.gatsby-highlight .token.entity,.gatsby-highlight .token.url,.gatsby-highlight .token.variable{color:#d7deea;}.gatsby-highlight .token.attr-value{color:#8dc891;}.gatsby-highlight .token.keyword{color:#c5a5c5;}.gatsby-highlight .token.atrule,.gatsby-highlight .token.class-name{color:#FAC863;}.gatsby-highlight .token.important{font-weight:400;}.gatsby-highlight .token.bold{font-weight:700;}.gatsby-highlight .token.italic{font-style:italic;}.gatsby-highlight .token.entity{cursor:help;}.gatsby-highlight>pre{height:auto!important;margin:1rem;white-space:pre-wrap;word-break:break-word;}.gatsby-highlight+.gatsby-highlight{margin-top:20px,;}.gatsby-highlight-code-line{background-color:#14161a;display:block;margin:-0.125rem calc(-1rem - 15px);padding:0.125rem calc(1rem + 15px);}</style><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css 1l9yz54 1q6mh99 m735s1 1q6mh99 m735s1 1q6mh99 m735s1 1q6mh99 m735s1 1q6mh99 m735s1">.css-1l9yz54{display:none;}@media (min-width: 540px){.css-1l9yz54{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-1q6mh99{color:#fff;-webkit-text-decoration:none;text-decoration:none;text-align:center;padding:5px 4px;white-space:nowrap;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transition:background 150ms;transition:background 150ms;border-radius:0.5em;}.css-1q6mh99:hover{background:rgba(255, 255, 255, 0.2);}@media (min-width: 780px){.css-1q6mh99{padding:5px 10px;}}.css-m735s1{width:16px;height:16px;color:#fff;fill:currentColor;}@media (min-width: 540px){.css-m735s1{width:24px;height:24px;}}@media (min-width: 1180px){.css-m735s1{margin:0 0 0 0;}}</style><style data-emotion="css z5ptlm">.css-z5ptlm{background-color:rgba(32, 35, 42, 0.95);color:#ffffff;display:block;position:auto;z-index:2000;width:100%;top:0;left:0;}@media (min-width: 780px){.css-z5ptlm{position:fixed;}}</style><header class="css-z5ptlm ejhzk945"><style data-emotion="css otpe3t">.css-otpe3t{padding-left:4px;padding-right:4px;margin-left:auto;margin-right:auto;max-width:1260px;}@media (min-width: 780px){.css-otpe3t{width:90%;padding-left:20px;padding-right:20px;}}</style><div class="css-otpe3t ejhzk944"><style data-emotion="css z95nvu">.css-z95nvu{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:60px;}</style><div class="css-z95nvu ejhzk943"><style data-emotion="css s0y9ho x9illq 192ssef">.css-s0y9ho{color:#46c9e5;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-right:10px;height:100%;-webkit-text-decoration:none;text-decoration:none;-webkit-flex-direction:center;-ms-flex-direction:center;flex-direction:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:none;}@media (min-width: 600px){.css-s0y9ho{width:calc(100% / 6);}}@media (min-width: 540px){.css-s0y9ho{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-x9illq{display:inline-block;vertical-align:top;}.css-192ssef{margin-left:10px;font-weight:bold;font-size:20px;line-height:20px;}</style><a class="css-s0y9ho" href="/"><img class="css-x9illq" height="60px" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjExNjMuMTI2IiB2aWV3Qm94PSIwIDAgMTI4NS41NjMgMTE2My4xMjYiIHdpZHRoPSIxMjg1LjU2MyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGNsaXBQYXRoIGlkPSJhIj48cGF0aCBkPSJtMCAwaDEyODUuNTYzdjExNjMuMTI2aC0xMjg1LjU2M3oiLz48L2NsaXBQYXRoPjxnIGNsaXAtcGF0aD0idXJsKCNhKSI+PHBhdGggZD0ibTExNjMuMTMxIDU1MC45NTV2NjEuMjE2aC02MS4yMTd2MjQ0Ljg2OWg2MS4yMTcgNjEuMjE2di0zMDYuMDg1eiIgZmlsbD0iIzc0NGUyNiIvPjxwYXRoIGQ9Im01NTAuOTU1IDc5NS44MjRoLTEyMi40Mzd2NjEuMjE2aC02MS4yMTZ2MTIyLjQzN2gxMjIuNDM3di02MS4yMTZoNjEuMjE2eiIgZmlsbD0iIzc0NGUyNiIvPjxwYXRoIGQ9Im05MTguMjYxIDYxMi4xNzFoLTYxLjIxNnYtNjEuMjE2aDYxLjIxNnptNjEuMjE3IDBoLTYxLjIxN3Y2MS4yMTZoNjEuMjE3em0xMjIuNDMyIDYxLjIxNnYxODMuNjUzaC0xMjIuNDMyLTEyMi40Mzd2NjEuMjE3aC0xMjIuNDMzLTE4My42NTN2LTE4My42NDloMTIyLjQzN3YtMTIyLjQzN2g2MS4yMTZ2NjEuMjE2aDE4My42NTN2NjEuMjIxaDYxLjIxN3YtNjEuMjIxem0tMzA2LjA4NiA2MS4yMjFoLTYxLjIxNnY2MS4yMTZoNjEuMjE2em0tMTgzLjY0OC0xMjIuNDM3aDYxLjIxNnYtNjEuMjE2aC02MS4yMTZ6IiBmaWxsPSIjNGVjMmM4Ii8+PHBhdGggZD0ibTkxOC4yNjEgMTIyLjQzMnYtNjEuMjE2aC00MjguNTE4djYxLjIxNmgtNjEuMjIxdjM2Ny4zMDJoMTIyLjQzN3YtNjEuMjE2aC02MS4yMTZ2LTEyMi40MzNoNjEuMjE2djEyMi40MzNoNjEuMjE3di0xMjIuNDMzaDEyMi40MzJ2LTEyMi40MzZoMTgzLjY1M3Y2MS4yMmg2MS4yMTd2LTEyMi40Mzd6IiBmaWxsPSIjNzQ0ZTI2Ii8+PHBhdGggZD0ibTk3OS40NzggMTIyLjQzNmg2MS4yMTZ2NjEuMjE3aC02MS4yMTZ6IiBmaWxsPSIjMmEyYTJhIi8+PHBhdGggZD0ibTYxMi4xNzEgNjEyLjE3MWg2MS4yMTd2MTIyLjQzN2gtMTgzLjY0OXYtNjEuMjE3aC0xMjIuNDM3di0xMjIuNDM2aDI0NC44Njl6bTM2Ny4zMDcgNjEuMjJoLTYxLjIxN3Y2MS4yMTdoNjEuMjE3em0tMjQ0Ljg3NCAxMjIuNDMzaDYxLjIxNnYtNjEuMjE2aC02MS4yMTZ6bTI0NC44NzQtNjEyLjE3MXY2MS4yMTZoNjEuMjE2djEyMi40MzNoLTYxLjIxNnYxODMuNjUzaC02MS4yMjF2NjEuMjE2aDEyMi40Mzd2LTYxLjIxNmg2MS4yMTZ2LTYxLjIxN2g2MS4yMTZ2LTYxLjIyLTEyMi40MzMtMTIyLjQzMnptLTEyMi40MzcgMzY3LjMwMmgtMTgzLjY1M3Y2MS4yMTZoNjEuMjE2djYxLjIyaDE4My42NTN2LTYxLjIyaC02MS4yMTZ6IiBmaWxsPSIjZmJkODAwIi8+PHBhdGggZD0ibTEyMjQuMzQ3IDQ4OS43MzR2LTQ4OS43MzRoLTYxLjIxNi03MzQuNjA5djYxLjIxNmgtNjEuMjE2djQyOC41MThoLTE4My42NTN2NjEuMjIxaC02MS4yMnYxODMuNjQ5aDI0NC44NzN2NjEuMjJoLTEyMi40Mzd2NjEuMjE2aC02MS4yMTZ2NjEuMjE3aDYxLjIxNnY2MS4yMmg2MS4yMTd2NjEuMjE2aDEyMi40MzZ2NjEuMjE3aDYxLjIxN3YtNjEuMjE3aDYxLjIxNnYtNjEuMjE2aDQyOC41MjN2LTYxLjIyaDMwNi4wODV2LTQyOC41MjN6bTAgMzY3LjMwNmgtMzY3LjMwNnY2MS4yMTdoLTM2Ny4zMDJ2NjEuMjJoLTEyMi40MzN2LTEyMi40MzdoNjEuMjE2di02MS4yMTZoMTIyLjQzM3YtNjEuMjJoLTYxLjIxNnYtNjEuMjE3aC0zMDYuMDg2di02MS4yMTZoNjEuMjE2di02MS4yMTZoMTIyLjQzNyAxODMuNjQ5di02MS4yMjFoLTEyMi40MzN2LTE4My42NDktMTgzLjY1M2g2MS4yMTd2LTYxLjIxNmg0MjguNTIydjYxLjIxNmg2MS4yMTd2LTYxLjIxNmgxODMuNjUzdjQyOC41MThoLTYxLjIyMXY2MS4yMjFoLTYxLjIxNnY2MS4yMTZoLTYxLjIxNnY2MS4yMTZoMTIyLjQzMnYtNjEuMjE2aDYxLjIyMXYtNjEuMjE2aDYxLjIxNnoiIGZpbGw9IiMyYTJhMmEiLz48cGF0aCBkPSJtODU3LjA0MSAzMDYuMDg1aC02MS4yMTd2LTYxLjIxNmg2MS4yMTd6bS02NzMuMzg4IDYxMi4xNzJoLTYxLjIxNnY2MS4yMTZoNjEuMjE2em0xODMuNjUzIDI0NC44NjloNjEuMjE2di02MS4yMTZoLTYxLjIxNnptLTE4My42NTMtNjEuMjE2aDYxLjIxNnYtNjEuMjE3aC02MS4yMTZ6bS0xODMuNjUzIDBoNjEuMjE2di02MS4yMTdoLTYxLjIxNnptOTc5LjQ3OC02NzMuMzkydi02MS4yMTZoLTE4My42NTR2NjEuMjE2aC02MS4yMTZ2MTIyLjQzN2gxMjIuNDMzIDEyMi40Mzd2LTYxLjIyMWgtMTIyLjQzN3YtNjEuMjE2eiIgZmlsbD0iIzJhMmEyYSIvPjxnIGZpbGw9IiNmZmYiPjxwYXRoIGQ9Im03OTUuODI0IDI0NC44NjloMTIyLjQzNnYtNjEuMjE2aC0xMjIuNDM2LTYxLjIxNnYxMjIuNDMyaDYxLjIxNnptNjEuMjE3IDYxLjIxNmgtNjEuMjE3djYxLjIxN2gyNDQuODcydi02MS4yMTdoLS4wMDJ2LTYxLjIxNmgtMTgzLjY1M3ptLTMwNi4wODYgMTIyLjQzM2gxODMuNjUzdjEyMi40MzdoLTE4My42NTN6bS02MS4yMTYtMTIyLjQzM2g2MS4yMTZ2MTIyLjQzM2gtNjEuMjE2em0xMjIuNDM3IDBoMTgzLjY0OHYxMjIuNDMzaC0xODMuNjQ4em0yNDQuODY1IDEyMi40MzNoMTIyLjQzN3Y2MS4yMTZoLTEyMi40Mzd6IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48cGF0aCBkPSJtMjQ0Ljg2OSA2NzMuMzkxaDEyMi40MzN2LTEyMi40MzZoLTEyMi40MzN2NjEuMjE4aC02MS4yMTZ2NjEuMjE4eiIvPjxwYXRoIGQ9Im0xMTYzLjEyNiAxMjIuNDM2aC4wMDV2LTYxLjIyaC0xODMuNjUzdjYxLjIyaDYxLjIxOHY2MS4yMTdoMTIyLjQzeiIvPjwvZz48L2c+PC9zdmc+" alt="Loige"/><span class="css-192ssef">Loige</span></a><style data-emotion="css 1ld37qd">.css-1ld37qd{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;overflow-x:auto;overflow-y:hidden;-webkit-overflow-scrolling:touch;height:100%;width:60%;}@media (min-width: 1180px){.css-1ld37qd{width:60%;}}</style><nav class="css-1ld37qd ejhzk942"><style data-emotion="css brnyfx 1f3jrqb">.css-brnyfx{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:#ffffff;-webkit-transition:color 0.2s ease-out;transition:color 0.2s ease-out;padding-left:15px;padding-right:15px;font-weight:300;-webkit-text-decoration:none;text-decoration:none;}@media (min-width: 1280px){.css-brnyfx{padding-left:20px;padding-right:20px;font-size:18px;}}.css-1f3jrqb{color:#46c9e5;position:relative;}</style><a class="css-brnyfx css-1f3jrqb" href="/"><style data-emotion="css 1eand3o">.css-1eand3o{position:absolute;bottom:-1px;height:4px;left:0px;right:0px;z-index:1;background:#46c9e5;}</style><span class="css-1eand3o e5yudoc0"></span>Blog</a><a class="css-brnyfx" href="/speaking">Speaking</a><a class="css-brnyfx" href="/about">About</a></nav><style data-emotion="css 150b3u1">.css-150b3u1{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-ms-flex-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end;overflow-x:auto;overflow-y:hidden;-webkit-overflow-scrolling:touch;height:100%;width:40%;}@media (min-width: 1180px){{width:40%;}}</style><div class="css-150b3u1 ejhzk941"><a rel="nofollow" class="css-1q6mh99" href="https://twitter.com/loige"><svg aria-label="Twitter" viewBox="0 0 24 24" width="1em" height="1em" class="css-m735s1" alt="Luciano&#x27;s Twitter profile"><path fill="currentColor" d="M23.954 4.569a10 10 0 0 1-2.825.775 4.958 4.958 0 0 0 2.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 0 0-8.384 4.482C7.691 8.094 4.066 6.13 1.64 3.161a4.822 4.822 0 0 0-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 0 1-2.228-.616v.061a4.923 4.923 0 0 0 3.946 4.827 4.996 4.996 0 0 1-2.212.085 4.937 4.937 0 0 0 4.604 3.417 9.868 9.868 0 0 1-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 0 0 7.557 2.209c9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63a9.936 9.936 0 0 0 2.46-2.548l-.047-.02z"></path></svg></a><a rel="nofollow" class="css-1q6mh99" href="https://twitch.tv/loige"><svg aria-label="Twitch" viewBox="0 0 24 24" width="1em" height="1em" class="css-m735s1" alt="Luciano&#x27;s Twitch profile"><path fill="currentColor" d="M.975 4.175v16.694h5.749V24h3.139l3.134-3.132h4.705l6.274-6.258V0H2.542zm3.658-2.09h17.252v11.479l-3.66 3.652h-5.751L9.34 20.343v-3.127H4.633z"></path><path fill="currentColor" d="M10.385 6.262h2.09v6.26h-2.09zM16.133 6.262h2.091v6.26h-2.091z"></path></svg></a><a rel="nofollow" class="css-1q6mh99" href="https://www.youtube.com/loige"><svg aria-label="Youtube" viewBox="0 0 24 24" width="1em" height="1em" class="css-m735s1" alt="Luciano&#x27;s YouTube profile"><path fill="currentColor" d="M23.469 5.929l.03.196a3.043 3.043 0 0 0-2.068-2.112l-.021-.005c-1.871-.508-9.4-.508-9.4-.508s-7.51-.01-9.4.508A3.044 3.044 0 0 0 .527 6.104l-.005.021c-.699 3.651-.704 8.038.031 11.947l-.031-.198a3.043 3.043 0 0 0 2.068 2.112l.021.005c1.869.509 9.4.509 9.4.509s7.509 0 9.4-.509a3.043 3.043 0 0 0 2.084-2.096l.005-.021c.318-1.698.5-3.652.5-5.648l-.001-.221.001-.23c0-1.997-.182-3.951-.531-5.846zM9.608 15.651V8.358l6.266 3.652z"></path></svg></a><a rel="nofollow" class="css-1q6mh99" href="https://www.linkedin.com/in/lucianomammino/"><svg aria-label="LinkedIn" viewBox="0 0 24 24" width="1em" height="1em" class="css-m735s1" alt="Luciano&#x27;s LinkedIn profile"><path fill="currentColor" d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a rel="nofollow" class="css-1q6mh99" href="https://github.com/lmammino"><svg aria-label="GitHub" viewBox="0 0 24 24" width="1em" height="1em" class="css-m735s1" alt="Luciano&#x27;s GitHub profile"><path fill="currentColor" d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></div></div></div><style data-emotion="css 1cfofik">.css-1cfofik{height:2px;display:block;transform-origin:left center 0px;-webkit-transform:scaleX(1);-moz-transform:scaleX(1);-ms-transform:scaleX(1);transform:scaleX(1);z-index:50;-webkit-transition:-webkit-transform 400ms ease 100ms;transition:transform 400ms ease 100ms;background:linear-gradient(90deg, #46c9e5, #d26ac2);}</style><span class="css-1cfofik ejhzk940"></span></header><style data-emotion="css gvup9u">.css-gvup9u{background-color:#46c9e5;background-repeat:no-repeat;-webkit-background-position:center;background-position:center;-webkit-background-size:cover;background-size:cover;width:100%;min-height:300px;height:50vh;display:table;}.css-gvup9u.small{max-height:300px;}.css-gvup9u.tiledBg{-webkit-background-size:auto;background-size:auto;background-repeat:repeat;}.css-gvup9u.bottomRightBg{-webkit-background-position:bottom right;background-position:bottom right;}.css-gvup9u.gradientOverlay{position:relative;z-index:-2;}.css-gvup9u.gradientOverlay:before{content:'';position:absolute;top:0;right:0;bottom:0;left:0;background-image:linear-gradient(to bottom right, #46c9e5, #d26ac2);opacity:0.6;z-index:-1;}@media (min-width: 780px){.css-gvup9u{height:70vh;}}</style><div class="textOverlay css-gvup9u ea1ziiz1" style="background-image:url(/static/1b3099eb0a746505ab3d3068302bf095/invite-only-microsites-with-nextjs-and-airtable.jpg)"><style data-emotion="css 1vmuur7">.css-1vmuur7{display:table-cell;vertical-align:middle;text-align:center;font-weight:700;color:#fff;padding:0 2em;color:white;text-shadow:1px 3px 0 #000,-1px -1px 0 #000,1px -1px 0 #000,-1px 1px 0 #000,1px 1px 0 #000;}@media (min-width: 780px){.css-1vmuur7{font-size:1.2em;}}.css-1vmuur7 h1{font-size:2em;line-height:1.6em;}.css-1vmuur7 h2{font-size:1.5em;margin:0.5em 0 0 0;line-height:1.6em;}.css-1vmuur7.textOverlay>*>span{background:#000000c4;display:inline;padding:0.2em;-webkit-box-decoration-break:clone;box-decoration-break:clone;-webkit-box-decoration-break:clone;}</style><div class="textOverlay css-1vmuur7 ea1ziiz0"><h1><span>Invite-only microsites with Next.js and AirTable</span></h1></div></div><style data-emotion="css 48rqd6">.css-48rqd6{min-height:100vh;margin:0 auto;padding-left:20px;padding-right:20px;max-width:1260px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}@media (min-width: 780px){.css-48rqd6{width:90%;}}</style><div class="css-48rqd6 e1kc7zwr4"><style data-emotion="css y3klfd">.css-y3klfd{-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><section class="css-y3klfd e1kc7zwr3"><style data-emotion="css 3igp7s">.css-3igp7s{-webkit-flex:1;-ms-flex:1;flex:1;}@media (min-width: 780px){.css-3igp7s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}</style><div class="css-3igp7s e1kc7zwr2"><style data-emotion="css nmfn">.css-nmfn{-webkit-flex:3;-ms-flex:3;flex:3;width:100%;}</style><main class="css-nmfn e1kc7zwr1"><style data-emotion="css t2ycg8">.css-t2ycg8{margin:2em 0;line-height:25px;padding:0 1em;}.css-t2ycg8 a{-webkit-text-decoration:none;text-decoration:none;color:inherit;}.css-t2ycg8 a:hover{-webkit-text-decoration:underline;text-decoration:underline;}@media (min-width: 780px){.css-t2ycg8{padding:0 2em;}}</style><div class="css-t2ycg8 ep8980s1"><style data-emotion="css 0 rm23k1">.css-rm23k1{margin:0 0.25em 0 0;}</style><style data-emotion="css 1o5dns8">.css-1o5dns8{vertical-align:middle;font-size:inherit;margin:0 0.5em;display:inline-block;}.css-1o5dns8 span{vertical-align:text-bottom;}</style><span style="margin-left:0" class="css-1o5dns8 e1r90wi10"><svg aria-hidden="true" data-prefix="far" data-icon="calendar-alt" class="css-rm23k1" viewBox="0 0 448 512" width="1em" height="1em"><path fill="currentColor" d="M148 288h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h48c26.5 0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3 0 6-2.7 6-6z"></path></svg><span>August 09, 2022</span></span><style data-emotion="css j1wil6">.css-j1wil6{vertical-align:middle;margin:0 0.5em 0 1em;display:inline-block;}.css-j1wil6 a{color:inherit;font-weight:bold;-webkit-text-decoration:none;text-decoration:none;vertical-align:text-bottom;}</style><span class="css-j1wil6 ex82wp61"><svg aria-hidden="true" data-prefix="fas" data-icon="tags" class="css-rm23k1" viewBox="0 0 640 512" width="1em" height="1em"><path fill="currentColor" d="M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z"></path></svg><a href="/tag/javascript">#<!-- -->javascript</a><style data-emotion="css 15kp1k9">.css-15kp1k9{vertical-align:text-bottom;}</style><span class="css-15kp1k9 ex82wp60">, </span><a href="/tag/typescript">#<!-- -->typescript</a><span class="css-15kp1k9 ex82wp60">, </span><a href="/tag/react">#<!-- -->react</a><span class="css-15kp1k9 ex82wp60">, </span><a href="/tag/nextjs">#<!-- -->nextjs</a><span class="css-15kp1k9 ex82wp60">, </span><a href="/tag/jwt">#<!-- -->jwt</a></span><a href="#comments" title="Read comments"><svg aria-hidden="true" data-prefix="fas" data-icon="comments" class="svg-inline--fa fa-comments fa-w-18" viewBox="0 0 576 512" width="1em" height="1em" style="margin:0 .25em 0 1em"><path fill="currentColor" d="M416 192c0-88.4-93.1-160-208-160S0 103.6 0 192c0 34.3 14.1 65.9 38 92-13.4 30.2-35.5 54.2-35.8 54.5-2.2 2.3-2.8 5.7-1.5 8.7S4.8 352 8 352c36.6 0 66.9-12.3 88.7-25 32.2 15.7 70.3 25 111.3 25 114.9 0 208-71.6 208-160zm122 220c23.9-26 38-57.7 38-92 0-66.9-53.5-124.2-129.3-148.1.9 6.6 1.3 13.3 1.3 20.1 0 105.9-107.7 192-240 192-10.8 0-21.3-.8-31.7-1.9C207.8 439.6 281.8 480 368 480c41 0 79.1-9.2 111.3-25 21.8 12.7 52.1 25 88.7 25 3.2 0 6.1-1.9 7.3-4.8 1.3-2.9.7-6.3-1.5-8.7-.3-.3-22.4-24.2-35.8-54.5z"></path></svg><span class="disqus-comment-count" data-disqus-identifier="invite-only-microsites-with-nextjs-and-airtable" data-disqus-url="https://loige.co/invite-only-microsites-with-nextjs-and-airtable">comments</span></a><p>‚Äî Published by<!-- --> <style data-emotion="css 1u9uk5p">.css-1u9uk5p{background:transparent!important;white-space:nowrap!important;color:#000!important;}.css-1u9uk5p:hover{-webkit-text-decoration:underline!important;text-decoration:underline!important;}</style><a href="https://twitter.com/loige" rel="nofollow noopener noreferrer" target="_blank" class="css-1u9uk5p e1ondplw2"><style data-emotion="css 1gejjbo">.css-1gejjbo{border-radius:50%;width:2em;height:2em;vertical-align:middle;display:inline-block;margin:0 .5em 0 0;overflow:hidden;}</style><img alt="Luciano Mammino&#x27;s profile picture" src="https://unavatar.now.sh/github/lmammino" class="css-1gejjbo e1ondplw1"/>Luciano Mammino</a></p></div><style data-emotion="css 1eveted">.css-1eveted{margin:2em 0;line-height:25px;padding:0 1em;}.css-1eveted code{white-space:pre-wrap;word-break:break-word;}@media (min-width: 780px){.css-1eveted{padding:0 2em;}}.css-1eveted a{background-color:rgba(187, 239, 253, 0.3);border-bottom:1px solid rgba(0, 0, 0, 0.2);-webkit-text-decoration:none;text-decoration:none;color:inherit;}.css-1eveted a:hover{background-color:#bbeffd;border-bottom-color:#1a1a1a;}.css-1eveted a.anchor,.css-1eveted a.gatsby-resp-image-link{background-color:transparent;border:none;}.css-1eveted a.anchor.before{position:absolute;top:64px;left:-1em;}.css-1eveted>p:first-of-type{font-size:18px;font-weight:300;color:#6d6d6d;}.css-1eveted>p:first-of-type a,.css-1eveted>p:first-of-type strong{font-weight:400;}@media (min-width: 780px){.css-1eveted>p:first-of-type{font-size:24px;}}.css-1eveted p{margin:1em 0 0 0;font-size:16px;line-height:1.7;max-width:42em;}@media (min-width: 780px){.css-1eveted p{font-size:17px;line-height:1.7;}}.css-1eveted h2,.css-1eveted h3,.css-1eveted h4,.css-1eveted h5{margin:2em 0 0 0;}.css-1eveted p>code,.css-1eveted li>code{background:rgba(255, 229, 100, 0.2);color:inherit;display:inline-block;padding:0 0.3em;}.css-1eveted p>code,.css-1eveted li>code,.css-1eveted p>a>code,.css-1eveted li>a>code{padding:0 3px;font-size:inherit;word-break:break-word;}.css-1eveted h2{border-top:1px solid #ececec;margin-top:2em;padding-top:2em;line-height:1.2;font-size:20px;}.css-1eveted h2:first-of-type{border-top:0;padding-top:0;}@media (min-width: 780px){.css-1eveted h2{font-size:35px;}}.css-1eveted hr+h2{border-top:0;margin-top:0;}.css-1eveted h3{padding-top:45px;font-size:18px;}@media (min-width: 780px){.css-1eveted h3{font-size:25px;line-height:1.3;}}.css-1eveted h2+h3,.css-1eveted h2+h3:first-of-type{padding-top:30px;}.css-1eveted h4{font-size:20px;color:#6d6d6d;line-height:1.3;margin-top:50px;font-weight:400;}.css-1eveted h4+p{margin-top:20px;}.css-1eveted ol,.css-1eveted ul{margin-top:20px;font-size:16px;padding-left:2em;}.css-1eveted ol p,.css-1eveted ul p,.css-1eveted ol p:first-of-type,.css-1eveted ul p:first-of-type{font-size:16px;margin-top:0;line-height:1.2;}.css-1eveted ol li,.css-1eveted ul li{margin-top:10px;}.css-1eveted img{max-width:100%;}.css-1eveted ol{list-style:decimal;}.css-1eveted ul{list-style:disc;}.css-1eveted blockquote{background-color:rgba(255, 229, 100, 0.3);border-left-color:#ffe564;border-left-width:9px;border-left-style:solid;padding:20px 45px 20px 26px;margin:1em 0 2em -1em;}@media (min-width: 780px){.css-1eveted blockquote{margin-left:-2em;}}.css-1eveted blockquote p{margin-top:15px;}.css-1eveted blockquote p:first-of-type{font-weight:700;margin-top:0;}.css-1eveted blockquote p:nth-of-type(2){margin-top:0;}.css-1eveted table{margin:1em auto;border-spacing:0;border-collapse:collapse;width:100%;}@media (min-width: 780px){.css-1eveted table{width:80%;}}.css-1eveted table td,.css-1eveted table th{border:1px solid #ccc;margin:0;padding:0.4em;}.css-1eveted table+legend{border-left:3px solid #ccc;font-size:small;font-style:italic;width:100%;margin:1em auto;padding:0 0 0 1em;}@media (min-width: 780px){.css-1eveted table+legend{width:80%;}}</style><article class="css-1eveted e1lcgljk0"><p>I recently needed to create an invite-only Next.js-powered microsite (for my wedding üå∏) and in this article I‚Äôm going to show you how I went about creating invite codes and how I implemented code validation in the app, using Next.js API endpoints and <a href="https://airtable.com/invite/r/fQpMoVmw">AirTable</a> as a lightweight backend.</p>
<h2 id="the-use-case-and-the-tech-stack" style="position:relative;"><a href="#the-use-case-and-the-tech-stack" aria-label="the use case and the tech stack permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The use case and the tech stack</h2>
<p>24 June 2022 was the best day of my life.</p>
<p>Seriously, I got married with the human being I love the most and everything was just perfect.</p>
<p>But we are not here to talk about my wedding, right?</p>
<p>Well, we kinda are, but in a nerdy kind of way that only software engineers can (hopefully) appreciate. OK, don‚Äôt tell my wife I said that‚Ä¶ ü§´</p>
<p>Specifically, we will discuss how to implement an invite-only microsite to share information with all the people invited to a private event.</p>
<p>Just to put things in context, let‚Äôs wear the PM hat for a second, and let‚Äôs discuss what kind of requirements did I impose on myself while building my wedding website:</p>
<ul>
<li>I wanted to be able to iterate quickly, mostly focusing on content and design, not much on infrastructure.</li>
<li>I wanted to build a simple solution that would be easy to host, maintain and update.</li>
<li>I wanted to have a very lightweight backend, possibly something managed.</li>
<li>Even better if I could give access to the data storage to someone else (my wife) so that we could collaborate on managing the data about the guests.</li>
<li>If I could host everything very cheaply (if not even freely), that would be great.</li>
</ul>
<p>For all the reasons above I settled for adopting the following pieces of tech:</p>
<ul>
<li><strong>Next.js</strong> for building a statically rendered frontend and the backend APIs</li>
<li>A private <strong>GitHub</strong> repository for managing the code of the Next.js app</li>
<li><strong>Vercel</strong> for hosting the project</li>
<li><strong>AirTable</strong> to store and manage all the data (invite codes, guests, rsvp, etc.)</li>
</ul>
<p>Keep in mind that Next.js is free and open source, GitHub can be used for free (even if you want to keep your repo private), and Vercel and AirTable have both generous free plans that are more than enough for this kind of use case.</p>
<p>With the stack above I ended up spending 0 money and I was able to complete the project in a couple of weekends! ü§ëüëå</p>
<h2 id="making-a-nextjs-site-private" style="position:relative;"><a href="#making-a-nextjs-site-private" aria-label="making a nextjs site private permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Making a Next.js site private</h2>
<p>On top of the requirements discussed above, my wedding website had 2 additional constraints:</p>
<ul>
<li>Every different guest should see something different (the website would look like a custom invite letter for them).</li>
<li>People without an invite code should not be able to access any content on the website.</li>
</ul>
<p>The following illustration shows how I went about making that happen in the context of a React SPA (Single Page Application):</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 69.921875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAABrklEQVQoz42SW4vbMBCF8/9/Tt8LfVloKZR0U5Zd2tzsxLZkW7J1HY00UnES2PZhd/M9DXM4MJezKndARIiYS8kLr/1VubX+46rlXK4lUWqapqqbc8Pbrud8iDHezPcgpWSM1edjVR/bphVC3MzDMNR1LcUopRBCxBj9AkCIziNRJqKYYh/qo33iUFGJ4CGluCLK8zwzxp+et/vDsevaaZqMNsMo6062XJaymJ1znT2M0HJXDf5sjM45r1JKJedZw6fPm9+HvpTinOOMnerq+eXPevNy2J3GqbeoUqSAARHhwjJ2SgkAECMftXWhlGyNUdp+W2/3VV+1/KndjGqwzmqtjTFaa++BiG47K6XGcVTaKmOMdRhCQOwa6R3knNRwNnJibbfb7va7/eHC68FCCM55bYMPkWh5FQBkRD0pIWRUMI8SjSuR9OMxze66Wkpp9WYqYux7+WP9iwmlrY+I/jTYPUNpCNBaS0Tv/bkf5MPDVzlb58AYM0mllVFSiV5Y6z4ICfhgBJslI8rLqVxwHiEkj+mawncTlgr//uVx+/OS0fyvcoc5Z1BBOnpL/wsRECi5xoRqxwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/351e82c1a746bb3aaa0b28d98cf76720/8d3d1/how-to-make-a-react-spa-invite-only.webp 256w,
/static/351e82c1a746bb3aaa0b28d98cf76720/354cf/how-to-make-a-react-spa-invite-only.webp 512w,
/static/351e82c1a746bb3aaa0b28d98cf76720/03f31/how-to-make-a-react-spa-invite-only.webp 1000w"
              sizes="(max-width: 1000px) 100vw, 1000px"
              type="image/webp"
            />
          <source
            srcset="/static/351e82c1a746bb3aaa0b28d98cf76720/85b06/how-to-make-a-react-spa-invite-only.png 256w,
/static/351e82c1a746bb3aaa0b28d98cf76720/bc282/how-to-make-a-react-spa-invite-only.png 512w,
/static/351e82c1a746bb3aaa0b28d98cf76720/da8b6/how-to-make-a-react-spa-invite-only.png 1000w"
            sizes="(max-width: 1000px) 100vw, 1000px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/351e82c1a746bb3aaa0b28d98cf76720/da8b6/how-to-make-a-react-spa-invite-only.png"
            alt="Illustration showing how to make a React SPA built with Next.js invite-only using AirTable as a data storage"
            title="Illustration showing how to make a React SPA built with Next.js invite-only using AirTable as a data storage"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
    </span></p>
<p>Please boost my ego for a second, isn‚Äôt this a beautiful illustration? üòú</p>
<p>OK, let‚Äôs be serious:</p>
<ol>
<li>The user loads the application by visiting the website with a personal invite code (passed as a query string parameter). When the page is loaded the React application starts on the client side. The app displays only a loading spinner at this stage.</li>
<li>The first thing that the application does is to read the invite code from the URL. At this point, it can call the backend (a Next.js API endpoint running on Vercel) to get the invite code validated. In turn, the backend requests the data storage (an AirTable spreadsheet) to check if the code exists (in which case it‚Äôs valid). If the code exists, the backend also returns the custom information associated with that invite code. For instance, the name of the invited person.</li>
<li>If the code is valid, the application has all the information to render the private website.</li>
<li>If it is not valid, an error message is displayed instead.</li>
</ol>
<h2 id="lets-build-an-invite-only-website" style="position:relative;"><a href="#lets-build-an-invite-only-website" aria-label="lets build an invite only website permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Let‚Äôs build an invite-only website!</h2>
<p>No, I am not going to show you my private wedding website (sorry, not sorry)!</p>
<p>Instead, we are going to build a more fictional example in this article: an invite-only website for a <strong>secret pizza party</strong>.
Here‚Äôs what different invites will look like:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 35.9375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABa0lEQVQoz3XLSW7TABhAYV+Yu4AELAoICpuqHjqEOI6Lg5S0dUI911McO4MdNTnF/1BpUCVEt5/eU7z8jKAwiPy34qenePmZeJkh/xheZvzteMn8/BzlNtKY+kf4zisZ337CjVVxI02mwRHBwaaxivvc8ZK5sYpijz+j995gWB/F6L/jp/tVnJtjUS9eY1gfDvYN5+YY7fJPx3/NfI9z/QUlWwxYLEdsdxPpdtc03UjSypSismkfxrJ9MtK5yWLpsN1P6B4OVplUj7abcHhR8sbES1SK5ru0e4emsyWrTfESjaLpy2Y3ou6uyGqTu0Qjb/ps9s/29D6aQ93ZKMVyyCzUifJLWbRXlCtb5quB+MkJaWnIejugbi3mzYAgPCHNDdbtgHptUTYWd+EpSX7OqrOpNzbKLDb5Ff1gGg7F9YfMYlPuC03KSicrNMlylftSJ4k1ykgnDzUyXyVNdIL4gjjqE4Y9wqBHlPT4DS8JzcNv43ofAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/0637de77f7d41a37c65e30d35bfea53a/8d3d1/sample-invites-pizza-party.webp 256w,
/static/0637de77f7d41a37c65e30d35bfea53a/354cf/sample-invites-pizza-party.webp 512w,
/static/0637de77f7d41a37c65e30d35bfea53a/44907/sample-invites-pizza-party.webp 1024w,
/static/0637de77f7d41a37c65e30d35bfea53a/a8642/sample-invites-pizza-party.webp 1536w,
/static/0637de77f7d41a37c65e30d35bfea53a/b1218/sample-invites-pizza-party.webp 2000w"
              sizes="(max-width: 1024px) 100vw, 1024px"
              type="image/webp"
            />
          <source
            srcset="/static/0637de77f7d41a37c65e30d35bfea53a/85b06/sample-invites-pizza-party.png 256w,
/static/0637de77f7d41a37c65e30d35bfea53a/bc282/sample-invites-pizza-party.png 512w,
/static/0637de77f7d41a37c65e30d35bfea53a/f1720/sample-invites-pizza-party.png 1024w,
/static/0637de77f7d41a37c65e30d35bfea53a/437a1/sample-invites-pizza-party.png 1536w,
/static/0637de77f7d41a37c65e30d35bfea53a/9fabd/sample-invites-pizza-party.png 2000w"
            sizes="(max-width: 1024px) 100vw, 1024px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/0637de77f7d41a37c65e30d35bfea53a/f1720/sample-invites-pizza-party.png"
            alt="Examples of different invites on our website"
            title="Examples of different invites on our website"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
    </span></p>
<p>As you can see from the picture, every guest (with a valid invite code) will get a custom invite page with their name, favorite color, etc.</p>
<p>If you want to see a preview, check out the following links:</p>
<ul>
<li><a href="https://secret-pizza-party.vercel.app/?code=14b25700-fe5b-45e8-a9be-4863b6239fcf">Leonardo‚Äôs invite</a></li>
<li><a href="https://secret-pizza-party.vercel.app/?code=ce7d5886-2166-4aee-8038-548f68b9739d">Michelangelo‚Äôs invite</a></li>
<li><a href="https://secret-pizza-party.vercel.app/?code=ef7ab7b7-33d5-43b9-ad73-e73bb8fd8e77">Raffaello‚Äôs invite</a></li>
<li><a href="https://secret-pizza-party.vercel.app/?code=b0cbb4a4-8a31-4bc1-bee9-d6fe39c1a6b3">Donatello‚Äôs invite</a></li>
</ul>
<p>Of course, if the invite code is missing or if it‚Äôs not valid, an <a href="https://secret-pizza-party.vercel.app/?invite=invalid">error page</a> is displayed.</p>
<p>If you are curious to take a look at the code, it‚Äôs all <a href="https://github.com/lmammino/secret-pizza-party">public and hosted on GitHub</a> (did you give it a star already?)‚Ä¶</p>
<h2 id="handling-sensitive-data-in-a-spa" style="position:relative;"><a href="#handling-sensitive-data-in-a-spa" aria-label="handling sensitive data in a spa permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Handling sensitive data in a SPA</h2>
<p>Sorry, I have to pause here for a second because before we get our hands dirty, we need to talk about‚Ä¶ <strong>Security</strong>! Security always comes first! üë∑‚Äç‚ôÄÔ∏è</p>
<p>It‚Äôs important to keep in mind that, with this particular design, all the UI logic and the content are already available in the JavaScript bundle representing the Single Page Application.</p>
<p>On top of that, the website is hosted on Vercel, so it‚Äôs publicly available on the internet.</p>
<p>Even if we end up displaying the ‚Äúinvalid invite‚Äù message to the user, a crafty user could still download all the frontend JavaScript code for our application and understand what should have been visualized with a valid invite.</p>
<p>Let me show you what I mean with a picture:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 59.375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAACBUlEQVQoz32RzW7TQBSF81qs2LFjxYoHYMdLsOAFkHgEJARNE1VJXwFonKYWqZ2UpM3E9sz4Z8bj8Yznx3/IESC1C46O7uJKn3TvOSPn9vyfF+uzm8082G9DlIIIozgBYYSTFITw7iE8RugQhAgnQQRTQotSjJ7AK3+GgkMhJBeKl2UIUYTwAwh3hwDFaUJIRvOM5gmhlBVP4Wtvdg8O21/7AzjGSRpBHEEMURxBhFGMcILjJM3osMHxCV6PHW/i3E4G2J8RQWJOiWTMCFJx0SgimWz1fVoQJQotiGSiVpSxkbMeL/3p0p9eb6bO7Xjlz3nFm65TVitrdG201ZUZXCojtbZNbWprrBWFGC29yY+bL+9fPv/49vVqd3HtzfbgmJG84CIjdA8gwrzgZcEFL8uCl0pppQdXSg/wlfv13YtnH968Wu0uXP8yACglpOt7Y0xwxDQrrNa1sX3X9Y81ctbnS3/67erT9+XnhXfubucY7mnO2q6vlAmPkKZplTNJcyNE2zTtoO40+j+BLX6eDV6fudsZgneUsrrts1Jv9hCESZzQOKZc6IIJRkvGJGMV1+3fqryJ400W67G7me127gMI2663tkYQ0yyrlNLG1nXdtu3jsx/37G7nWbSjSdqcHqQshxGWolJVJYRsmuZ/8M3mMiexltKeaCmrAAQEHAWhtn4a2G+/Ln0Jb0RVYwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/42c530a92429ba2f8a2c5a8171475ef2/8d3d1/disclosing-sensitive-information-in-bundled-code.webp 256w,
/static/42c530a92429ba2f8a2c5a8171475ef2/354cf/disclosing-sensitive-information-in-bundled-code.webp 512w,
/static/42c530a92429ba2f8a2c5a8171475ef2/44907/disclosing-sensitive-information-in-bundled-code.webp 1024w,
/static/42c530a92429ba2f8a2c5a8171475ef2/a8642/disclosing-sensitive-information-in-bundled-code.webp 1536w,
/static/42c530a92429ba2f8a2c5a8171475ef2/705b1/disclosing-sensitive-information-in-bundled-code.webp 2048w,
/static/42c530a92429ba2f8a2c5a8171475ef2/e84fa/disclosing-sensitive-information-in-bundled-code.webp 2118w"
              sizes="(max-width: 1024px) 100vw, 1024px"
              type="image/webp"
            />
          <source
            srcset="/static/42c530a92429ba2f8a2c5a8171475ef2/85b06/disclosing-sensitive-information-in-bundled-code.png 256w,
/static/42c530a92429ba2f8a2c5a8171475ef2/bc282/disclosing-sensitive-information-in-bundled-code.png 512w,
/static/42c530a92429ba2f8a2c5a8171475ef2/f1720/disclosing-sensitive-information-in-bundled-code.png 1024w,
/static/42c530a92429ba2f8a2c5a8171475ef2/437a1/disclosing-sensitive-information-in-bundled-code.png 1536w,
/static/42c530a92429ba2f8a2c5a8171475ef2/7b24f/disclosing-sensitive-information-in-bundled-code.png 2048w,
/static/42c530a92429ba2f8a2c5a8171475ef2/17073/disclosing-sensitive-information-in-bundled-code.png 2118w"
            sizes="(max-width: 1024px) 100vw, 1024px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/42c530a92429ba2f8a2c5a8171475ef2/f1720/disclosing-sensitive-information-in-bundled-code.png"
            alt="Disclosing sensitive information in the JavaScript bundled code"
            title="Disclosing sensitive information in the JavaScript bundled code"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
    </span></p>
<p>In a dummy version of this website, I was keeping all the sensitive data (for instance here, the date and place of the event) hardcoded in my JSX code. This means that an experienced user, even if they don‚Äôt have a valid invite code, could technically have a peek at the JavaScript bundle and extrapolate a lot of sensitive information.</p>
<p>For this reason, it‚Äôs important to keep any sensitive information outside the frontend code. In the case of a wedding website, you probably wouldn‚Äôt want to disclose to the entire world things like the event date, the location, emergency phone numbers, etc.</p>
<p>All the data that we need to keep private (only available to someone with a valid invite code) must be fetched doing an API call to the backend.</p>
<p>In a way, we can imagine the invite code as an API key that gives people access not just to the website, but also to all the sensitive data that the website will display.</p>
<p>Of course, make sure to keep your repository private, otherwise, that might become another way to access sensitive information embedded in your API code‚Ä¶</p>
<p>Finally, it‚Äôs also important that your user understand that they shouldn‚Äôt be sharing their unique URL with other people. So make sure to warn them when you send them the invite URL.</p>
<p>In summary, here are some good security rules we will abide by:</p>
<ol>
<li>The website is public</li>
<li>We are enforcing access control from the client side</li>
<li>The client-side cannot be trusted (all its code is publicly accessible)</li>
<li>A backend needs to be used to validate the code and return any sensitive information that needs to be accessible only with a valid invite code.</li>
<li>For extra security, keep your repo private and make sure your user won‚Äôt share their invite URL with other people!</li>
</ol>
<h2 id="generating-and-storing-invite-codes" style="position:relative;"><a href="#generating-and-storing-invite-codes" aria-label="generating and storing invite codes permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Generating and storing invite codes</h2>
<p>We said we are going to be using <a href="https://airtable.com/invite/r/fQpMoVmw">AirTable</a> as storage for invite code and related information.</p>
<p>AirTable is a SaaS that allows you to easily manage different kinds of datasets. You can do a lot through its web interface, but you can also use the data programmatically, turning it into a convenience database for simple types of applications.</p>
<p>For this particular use case, Airtable offers a <a href="https://support.airtable.com/hc/en-us/articles/203313985-Public-REST-API">public REST API</a> and SDKs in various programming languages, including <a href="https://github.com/airtable/airtable.js">JavaScript</a>.</p>
<p>We can start by creating a new <em>base</em> (which is kinda a workspace in AirTable lingo) and create a grid data view into it.</p>
<p>This first data table will contain all our invite codes, so let‚Äôs call it <strong>invites</strong>:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 26.171875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAElEQVQY01WITU6DQBiGuUQxsSsXpcZuXHgNL+AR3HslF6DGG7iUSAsFq92SoSDQduhQfob55mOM6MYnb548ebXbt7vrl5uzp8vJ89XJ/fmpdTF+nI0fZro5HZnGyJzoljGEoVuGbk3/Yng0zipC01cyX2fr5Ze/iD07dOzQcRPfIQs38e3QmUfe+/bTSwI3XgbZykt8P1sF+YeWljWtWtGrDn/WowIOu3RXUlZsC7Y/lJQ1x0b1qi4ryUGhovleDKEdWig7UQFWgEchWwlNW5Mo2iQxicgmidM8Y0eGClnJZI+AkhYUEASCpv6DiADQDXDOfy0ApJRd18kBGCwAvgFnY/QbrGHgxQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/ee985d580ec45bc135f299c2c0dd2fed/8d3d1/airtable-sample-table.webp 256w,
/static/ee985d580ec45bc135f299c2c0dd2fed/354cf/airtable-sample-table.webp 512w,
/static/ee985d580ec45bc135f299c2c0dd2fed/44907/airtable-sample-table.webp 1024w,
/static/ee985d580ec45bc135f299c2c0dd2fed/5cb8f/airtable-sample-table.webp 1270w"
              sizes="(max-width: 1024px) 100vw, 1024px"
              type="image/webp"
            />
          <source
            srcset="/static/ee985d580ec45bc135f299c2c0dd2fed/85b06/airtable-sample-table.png 256w,
/static/ee985d580ec45bc135f299c2c0dd2fed/bc282/airtable-sample-table.png 512w,
/static/ee985d580ec45bc135f299c2c0dd2fed/f1720/airtable-sample-table.png 1024w,
/static/ee985d580ec45bc135f299c2c0dd2fed/caada/airtable-sample-table.png 1270w"
            sizes="(max-width: 1024px) 100vw, 1024px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/ee985d580ec45bc135f299c2c0dd2fed/f1720/airtable-sample-table.png"
            alt="An example of how we could structure the AirTable table"
            title="An example of how we could structure the AirTable table"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
    </span></p>
<p>As displayed in the picture above we are adding a few fields there:</p>
<ul>
<li><code>invite</code>: a UUID that represents the invite code</li>
<li><code>name</code>: the name of the invited guest</li>
<li><code>favouriteColor</code>the favorite color of the guest</li>
<li><code>weapon</code>the weapons of the guest (small note: in real life I am not pro weapons, but if you haven‚Äôt got it yet, we are talking about Mutant Ninja Turtles‚Ñ¢Ô∏è here‚Ä¶ üòù)</li>
</ul>
<p>This makes sense for our fictional example. In a more generic use case, you‚Äôll be adding here all the pieces of information that are unique for every single guest.
Note that on this website we also have a mini RSVP form. This means that we will be able to collect some data from the users. This is also something that we will be storing in AirTable.</p>
<details style="margin-top: 1em">
  <summary>Are you following along and want an easy way to import this table into your Airtable base? (expand here)</summary>
  <div style="background: #eee; margin-top: 1em; padding: 1em; border: 2px dotted #ccc; border-radius: 10px;">
<p>Airtable allows to import data into a base from a CSV, so here‚Äôs my example data in CSV format:</p>
<div class="gatsby-highlight" data-language="csv"><pre class="language-csv"><code class="language-csv"><span class="token value">invite</span><span class="token punctuation">,</span><span class="token value">name</span><span class="token punctuation">,</span><span class="token value">favouriteColor</span><span class="token punctuation">,</span><span class="token value">weapon</span>
<span class="token value">14b25700-fe5b-45e8-a9be-4863b6239fcf</span><span class="token punctuation">,</span><span class="token value">Leonardo</span><span class="token punctuation">,</span><span class="token value">blue</span><span class="token punctuation">,</span><span class="token value">Twin Katana</span>
<span class="token value">ce7d5886-2166-4aee-8038-548f68b9739d</span><span class="token punctuation">,</span><span class="token value">Michelangelo</span><span class="token punctuation">,</span><span class="token value">orange</span><span class="token punctuation">,</span><span class="token value">Nunchaku</span>
<span class="token value">ef7ab7b7-33d5-43b9-ad73-e73bb8fd8e77</span><span class="token punctuation">,</span><span class="token value">Raffaello</span><span class="token punctuation">,</span><span class="token value">red</span><span class="token punctuation">,</span><span class="token value">Twin Sai</span>
<span class="token value">b0cbb4a4-8a31-4bc1-bee9-d6fe39c1a6b3</span><span class="token punctuation">,</span><span class="token value">Donatello</span><span class="token punctuation">,</span><span class="token value">purple</span><span class="token punctuation">,</span><span class="token value">Bo</span></code></pre></div>
  </div>
</details>
<h2 id="reading-invite-codes-using-the-airtable-sdk" style="position:relative;"><a href="#reading-invite-codes-using-the-airtable-sdk" aria-label="reading invite codes using the airtable sdk permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Reading invite codes using the AirTable SDK</h2>
<blockquote>
<p><strong>Note</strong>: from this point I will assume that you have already scaffolded your Next.js application. If you need help doing that you can check out <a href="https://nextjs.org/learn/basics/create-nextjs-app">The official Next.js docs</a> or just run the following command:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">npx <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="80e3f2e5e1f4e5adeee5f8f4ade1f0f0c0ece1f4e5f3f4">[email&#160;protected]</a> --typescript --use-npm</code></pre></div>
<p>Also note that, at the time of writing, I am using <strong>Next.js version 12.2</strong>. If you are reading this in a distant future, you might have to change something in the following code examples!</p>
</blockquote>
<p>Because we are using TypeScript, the first thing that we want to do is spend a few minutes to think how to represent our invites.</p>
<p>The easiest thing I could come up with was to create a file called <code>types/invite.ts</code> with the following definition:</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Invite</span> <span class="token punctuation">{</span>
  code<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  favouriteColor<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  weapon<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  coming<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></code></pre></div>
<p>This should probably be enough for our use case.</p>
<p>Now is the time to start writing some code to interact with the data on our AirTable <em>base</em>.</p>
<p>To do that, the first thing we need to install the <code>airtable</code> package:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> i --save airtable</code></pre></div>
<p>We will also need to grab our Airtable API KEY from the <a href="https://airtable.com/account">AirTable account page</a> and the <em>base ID</em> from the <a href="https://airtable.com/api">API page</a> (select your workspace and the API docs should show you the <em>base ID</em> in the introduction section).</p>
<p>For development convenience we are going to store these two variables as environment variables:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">AIRTABLE_API_KEY</span><span class="token operator">=</span><span class="token string">"put your api key here"</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">AIRTABLE_BASE_ID</span><span class="token operator">=</span><span class="token string">"put your base id here"</span></code></pre></div>
<p>If you go back to the API docs, you might appreciate that the docs are automatically generated for your workspace. You should see a section called ‚Äúinvites table‚Äù describing all the fields available in our grid!</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 52.34375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABlElEQVQoz4XSaUojQRgG4L6FMDB/FMJk0cROL4qi5xkGl+h4GFFQO9FTqKcQvIPd6em1uvZ3qErcINGCl/p+VD98X1U70zoFKQmKqoRUElJKCCFsTM05h1n3D4/4/ecAo5MzHI1OP+f4FMcnf3E4OoPzlDzjpUxACEXDGgsY6BVmjFnw/OISKz9+otXuYa3VXhonzhNUpEKW5cjzHEVRoK5rlGUJSqmNWVc3EVqdDXjhDlx/a2kcrTSk4JBKgEoGpRSEFCC0gdbadmnWZDKGv/kL+7seBsNgaRxzWEkOpaUFDWLukvF5LaUF724juIM2gjD8HhSMgHP61qEBKaNzcNbh7SRCp9vDwNv+GtQApGDQUODafKwtajq03Sv5Aexg4G2h7wZvWdhh0zQo7CMwcC4WvnI0HqPb69qRh76PoefD9fzFoHnVOEnwEidIpv+Q5RnKogQhNaqqsuB1NMF6v48wnEHuB7Dvmt23u2PuyYxoRqspwTRLEacx0jS2YE3I7Le5jrDac7G7t40wGM6hwELvdYD/rLM5C/hPkhcAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/e55050e522f065e3cb63a2f1fad297f4/8d3d1/airtable-api-documentation-page.webp 256w,
/static/e55050e522f065e3cb63a2f1fad297f4/354cf/airtable-api-documentation-page.webp 512w,
/static/e55050e522f065e3cb63a2f1fad297f4/44907/airtable-api-documentation-page.webp 1024w,
/static/e55050e522f065e3cb63a2f1fad297f4/a8642/airtable-api-documentation-page.webp 1536w,
/static/e55050e522f065e3cb63a2f1fad297f4/705b1/airtable-api-documentation-page.webp 2048w,
/static/e55050e522f065e3cb63a2f1fad297f4/5b89e/airtable-api-documentation-page.webp 2552w"
              sizes="(max-width: 1024px) 100vw, 1024px"
              type="image/webp"
            />
          <source
            srcset="/static/e55050e522f065e3cb63a2f1fad297f4/85b06/airtable-api-documentation-page.png 256w,
/static/e55050e522f065e3cb63a2f1fad297f4/bc282/airtable-api-documentation-page.png 512w,
/static/e55050e522f065e3cb63a2f1fad297f4/f1720/airtable-api-documentation-page.png 1024w,
/static/e55050e522f065e3cb63a2f1fad297f4/437a1/airtable-api-documentation-page.png 1536w,
/static/e55050e522f065e3cb63a2f1fad297f4/7b24f/airtable-api-documentation-page.png 2048w,
/static/e55050e522f065e3cb63a2f1fad297f4/d9340/airtable-api-documentation-page.png 2552w"
            sizes="(max-width: 1024px) 100vw, 1024px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/e55050e522f065e3cb63a2f1fad297f4/f1720/airtable-api-documentation-page.png"
            alt="Example of documentation page for AirTable"
            title="Example of documentation page for AirTable"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
    </span></p>
<p>Isn‚Äôt this an awesome way to provide documentation?! And you can even get a bunch of <code>curl</code> and JavaScript code examples.</p>
<p>What we want to do right now is to be able to retrieve a record by invite code. One way to do that is to list all the records and use a filter to try to match based on our invite code field. We can visit the section <em>List records</em> to have a feeling for how we could do that. If we switch to the JavaScript code example we will see something like this:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> Airtable <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'airtable'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> base <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Airtable</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">apiKey</span><span class="token operator">:</span> <span class="token string">'YOUR_API_KEY'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">base</span><span class="token punctuation">(</span><span class="token string">'YOUR_BASE_ID'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">base</span><span class="token punctuation">(</span><span class="token string">'invites'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">// Selecting the first 3 records in Grid view:</span>
    <span class="token literal-property property">maxRecords</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token literal-property property">view</span><span class="token operator">:</span> <span class="token string">"Grid view"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eachPage</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">page</span><span class="token punctuation">(</span><span class="token parameter">records<span class="token punctuation">,</span> fetchNextPage</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// This function (`page`) will get called for each page of records.</span>

    records<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">record</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Retrieved'</span><span class="token punctuation">,</span> record<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'invite'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// To fetch the next page of records, call `fetchNextPage`.</span>
    <span class="token comment">// If there are more records, `page` will get called again.</span>
    <span class="token comment">// If there are no more records, `done` will get called.</span>
    <span class="token function">fetchNextPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token function">done</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>OK Airtable, you did such a great job with the auto-generated docs, but come on! What kind of JavaScript is this?! Still using <code>var</code>, <em>CommonJS</em>, and <em>callbacks</em>? üò¢</p>
<p>Well, I guess we will need to roll up our sleeves and do a bit of extra work to make this nice and modern‚Ä¶</p>
<p>Let‚Äôs start by creating a new file called <code>utils/airtable.ts</code> and let‚Äôs create a helper function there to get an invite by id:</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> Airtable <span class="token keyword">from</span> <span class="token string">'airtable'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Invite <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../types/invite'</span>

<span class="token comment">// make sure all the necessary env vars are set</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">AIRTABLE_API_KEY</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'AIRTABLE_API_KEY is not set'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">AIRTABLE_BASE_ID</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'AIRTABLE_BASE_ID is not set'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// create a new Airtable client and gets a reference to the</span>
<span class="token comment">// airtable base containing our invites</span>
<span class="token keyword">const</span> airtable <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Airtable</span><span class="token punctuation">(</span><span class="token punctuation">{</span> apiKey<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">AIRTABLE_API_KEY</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> base <span class="token operator">=</span> airtable<span class="token punctuation">.</span><span class="token function">base</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">AIRTABLE_BASE_ID</span><span class="token punctuation">)</span>

<span class="token comment">// get an invite by invite code (promisified)</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getInvite</span> <span class="token punctuation">(</span>inviteCode<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Invite<span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">base</span><span class="token punctuation">(</span><span class="token string">'invites'</span><span class="token punctuation">)</span>
      <span class="token comment">// runs a query on the `invites` table</span>
      <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        filterByFormula<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">{invite} = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">escape</span><span class="token punctuation">(</span>inviteCode<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        maxRecords<span class="token operator">:</span> <span class="token number">1</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token comment">// reads the first page of results</span>
      <span class="token punctuation">.</span><span class="token function">firstPage</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> records<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// propagate errors</span>
          <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
          <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// if the record could not be found</span>
        <span class="token comment">// we consider it an error</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>records <span class="token operator">||</span> records<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Invite not found'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// otherwise we create an invite object from the first record</span>
        <span class="token comment">// (there should be only one with the give code) and return it</span>
        <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token punctuation">{</span>
          code<span class="token operator">:</span> <span class="token function">String</span><span class="token punctuation">(</span>records<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fields<span class="token punctuation">.</span>invite<span class="token punctuation">)</span><span class="token punctuation">,</span>
          name<span class="token operator">:</span> <span class="token function">String</span><span class="token punctuation">(</span>records<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fields<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span>
          favouriteColor<span class="token operator">:</span> <span class="token function">String</span><span class="token punctuation">(</span>records<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fields<span class="token punctuation">.</span>favouriteColor<span class="token punctuation">)</span><span class="token punctuation">,</span>
          weapon<span class="token operator">:</span> <span class="token function">String</span><span class="token punctuation">(</span>records<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fields<span class="token punctuation">.</span>weapon<span class="token punctuation">)</span><span class="token punctuation">,</span>
          coming<span class="token operator">:</span> <span class="token keyword">typeof</span> records<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fields<span class="token punctuation">.</span>coming <span class="token operator">===</span> <span class="token string">'undefined'</span>
            <span class="token operator">?</span> <span class="token keyword">undefined</span>
            <span class="token operator">:</span> records<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fields<span class="token punctuation">.</span>coming <span class="token operator">===</span> <span class="token string">'yes'</span>
        <span class="token punctuation">}</span>

        <span class="token function">resolve</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>I left enough comments in the code, that an additional explanation should not be necessary!
We are essentially using the <code>airtable</code> SDK and building a nicer promise-based interface to get an invite by invite code.</p>
<p>Ok, for the eagle-eyed ones, you are probably wondering where the heck is that <code>escape</code> function coming from?! I elided it from the code to keep things simple. The TLDR; is that <strong>it makes things more secure</strong> by reducing the risk of <em>injections</em>.</p>
<details style="margin-top: 1em">
  <summary>But "the how" needs a bit of a long-ish explanation (expand here if you are curious. Yes, you should be!).</summary>
  <div style="background: #eee; margin-top: 1em; padding: 1em; border: 2px dotted #ccc; border-radius: 10px;">
<p>Every time you use user input to construct some kind of query, your spider senses should be immediately triggered! üï∑</p>
<p>The invite code is, in fact, user-controlled. It‚Äôs part of the query string in the URL. A user can decide to change that and try to see what happens with different values.</p>
<p>If the user inputs <code>?code=14b25700-fe5b-45e8-a9be-4863b6239fcf</code> as invite code, with a na√Øve string interpolation, we would be producing the following Airtable formula:</p>
<div class="gatsby-highlight" data-language="plain"><pre class="language-plain"><code class="language-plain">{invite} = '14b25700-fe5b-45e8-a9be-4863b6239fcf'</code></pre></div>
<p>But what if a very evil user tries something like <code>?code=%27%20>%3D%200%20%26%20%27</code> (<code>?code=' >= 0 &#x26; '</code> unencoded)?!</p>
<p>In this case, we end up constructing the following Airtable formula:</p>
<div class="gatsby-highlight" data-language="plain"><pre class="language-plain"><code class="language-plain">{invite} = '' >= 0 &amp; ''</code></pre></div>
<p>Which always evaluates to <code>1</code> (<code>true</code>) for every record in the table! So this very evil user is now accessing your private website without having to know a valid code. They will just get the code of the first record that Airtable matches in the table! If you don‚Äôt believe me you can try this attack by yourself <a href="https://secret-pizza-party-fgpypfb66-lmammino.vercel.app/?code=%27%20%3E%3D%200%20%26%20%27">with this link</a> (running on a <a href="https://github.com/lmammino/secret-pizza-party/tree/vulnerable">vulnerable branch</a> of the app where we don‚Äôt perform the escape).</p>
<p>This is like <a href="https://owasp.org/www-community/attacks/SQL_Injection">SQL injections</a> but for Airtable filter formulas! üò±</p>
<p>The <code>escape</code> function, allows us to try to sanitize user input and escape dangerous characters like <code>'</code> and <code>"</code> which might allow a malicious actor to alter the structure of our filter formula.</p>
<p>If you are curious this is my basic implementation of the <code>escape</code> function (the one I used in this project), but I have to say I am quite disappointed that Airtable does not provide a built-in utility for this in their SDK and that they don‚Äôt warn their users about this threat in their docs‚Ä¶ üôÅ</p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token function">escape</span> <span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'BLANK()'</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> escapedString <span class="token operator">=</span> value
      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">'</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">"\\'"</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\r</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">'\\\\'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\n</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">'\\n'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\t</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">'\\t'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">'</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>escapedString<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">String</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">'boolean'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> value <span class="token operator">?</span> <span class="token string">'1'</span> <span class="token operator">:</span> <span class="token string">'0'</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">throw</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">'Invalid value received'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Note that <strong>this function does not claim to be perfect or comprehensive</strong>. I haven‚Äôt extensively tested it, nor do I know all the bells and whistles of the formula syntax to be able to do that. If you are doing something like this in your code, make sure to test this extensively.</p>
<p>PS: I nudged Airtable <a href="https://twitter.com/loige/status/1555622372085997569">on Twitter</a> (with no response) and <a href="https://community.airtable.com/t/standard-way-to-prevent-formula-injections-when-using-airtable-as-a-backend-through-sdk/50283">their community forum</a> (well, let‚Äôs just say that the thread wasn‚Äôt received particularly well by some members of the community and that the conversation derailed a little‚Ä¶). I also reached out to their support channels and, hopefully, this will get somewhere‚Ä¶</p>
  </div>
</details>
<p>Now that we have created this utility function, we can use it in an API to be able to provide code validation and invite data to the frontend.</p>
<h2 id="nextjs-invite-endpoint" style="position:relative;"><a href="#nextjs-invite-endpoint" aria-label="nextjs invite endpoint permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Next.js invite endpoint</h2>
<p>I am generally not a big fan of convention-based frameworks like Next.js. Conventions cannot be comprehensive and sometimes you find yourself trying to adapt your problem to whatever convention the framework is forcing you to use, rather than adopting the optimal approach for the problem at hand.</p>
<p>In any case, I find that I enjoy using Next.js for small personal projects. The level of productivity is generally quite high and Next.js can make your life easy in many different ways.</p>
<p>One of the features that I love the most is how easy it is to build APIs for the frontend application.</p>
<p>To create an API endpoint you just need to create a file under <code>pages/api</code>. For instance, if you want to create a hello world API, you could simply create the following file in <code>pages/api/hello.ts</code>:</p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> NextApiRequest<span class="token punctuation">,</span> NextApiResponse <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'next'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">handler</span> <span class="token punctuation">(</span>
  req<span class="token operator">:</span> NextApiRequest<span class="token punctuation">,</span>
  res<span class="token operator">:</span> NextApiResponse<span class="token operator">&lt;</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token operator">></span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">'Hello World'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Now you can simply call this API by sending a request to <code>http://localhost:3000/api/hello</code>. The convention says that the API path follows the file name (<code>hello.ts</code> -> <code>/api/hello</code>):</p>
<div class="gatsby-highlight" data-language="plain"><pre class="language-plain"><code class="language-plain">‚ùØ curl -i http://localhost:3000/api/hello
HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8
ETag: "19-c6Hfa5VVP+Ghysj+6y9cPi5QQbk"
Content-Length: 25
Vary: Accept-Encoding
Date: Sun, 07 Aug 2022 16:25:20 GMT
Connection: keep-alive
Keep-Alive: timeout=5

{"message":"Hello World"}</code></pre></div>
<p>If you want to learn more about how to create API endpoints with Next.js check out the <a href="https://nextjs.org/docs/api-routes/introduction">official documentation</a>.</p>
<p>Ok, so let‚Äôs use what we just learned to create an API endpoint that allows the frontend to validate the user invite code and retrieve the related invite data. Let‚Äôs create write our code in <code>pages/api/invite.ts</code>:</p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> NextApiRequest<span class="token punctuation">,</span> NextApiResponse <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'next'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> InviteResponse <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../types/invite'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getInvite <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../utils/airtable'</span>
<span class="token keyword">import</span> messages <span class="token keyword">from</span> <span class="token string">'../../data/messages'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">handler</span> <span class="token punctuation">(</span>
  req<span class="token operator">:</span> NextApiRequest<span class="token punctuation">,</span>
  res<span class="token operator">:</span> NextApiResponse<span class="token operator">&lt;</span>InviteResponse <span class="token operator">|</span> <span class="token punctuation">{</span> error<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token operator">></span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// if the request is not a GET, return an error</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>method <span class="token operator">!==</span> <span class="token string">'GET'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">405</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> error<span class="token operator">:</span> <span class="token string">'Method Not Allowed'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// if the code is missing we return a 400 error</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> error<span class="token operator">:</span> <span class="token string">'Missing invite code'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// If there are multiple invite codes (?code=x&amp;code=y)</span>
  <span class="token comment">// we pick the first one and ignore the rest</span>
  <span class="token keyword">const</span> code <span class="token operator">=</span> <span class="token builtin">Array</span><span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>code<span class="token punctuation">)</span>
    <span class="token operator">?</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>code<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token operator">:</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>code

  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token comment">// we use our Airtable utility to get the invite data for a given code</span>
    <span class="token comment">// and return the result to the user</span>
    <span class="token keyword">const</span> invite <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getInvite</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> invite<span class="token punctuation">,</span> messages <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// In case of error we return either a 401 or a 500 error:</span>
    <span class="token comment">// - if the code was not found we return 401</span>
    <span class="token comment">// - otherwise we return a generic 500 server error</span>
    <span class="token keyword">const</span> e <span class="token operator">=</span> <span class="token punctuation">(</span>err <span class="token keyword">as</span> Error<span class="token punctuation">)</span>
    res
      <span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>message <span class="token operator">===</span> <span class="token string">'Invite not found'</span> <span class="token operator">?</span> <span class="token number">401</span> <span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> error<span class="token operator">:</span> e<span class="token punctuation">.</span>message <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Once again the code is sufficiently commented out, so, hopefully, it‚Äôs easy enough to follow.</p>
<p>But there are a few details that we need to discuss: what the <code>InviteResponse</code> type is and what the <code>messages</code> variable is.</p>
<p><code>InviteResponse</code> is a type that I have sneakily added to <code>types/invite.ts</code>, which now looks like this:</p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> Messages <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../data/messages'</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Invite</span> <span class="token punctuation">{</span>
  <span class="token comment">// ... (unchanged, elided for brevity)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">InviteResponse</span> <span class="token punctuation">{</span>
  invite<span class="token operator">:</span> Invite<span class="token punctuation">,</span>
  messages<span class="token operator">:</span> Messages
<span class="token punctuation">}</span></code></pre></div>
<p>The idea is that when a user has a valid code we want this API to return 2 different pieces of information:</p>
<ol>
<li>All the data associated with the invite (inside <code>invite</code>)</li>
<li>All the sensitive messages that the UI will need to display to <em>authenticated</em> users.</li>
</ol>
<p>All the messages are stored in <code>data/messages.ts</code>, which currently looks like this:</p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> messages <span class="token operator">=</span> <span class="token punctuation">{</span>
  title<span class="token operator">:</span> <span class="token string">'Secret Pizza Party!'</span><span class="token punctuation">,</span>
  date_and_place<span class="token operator">:</span> <span class="token string">'Dec 31st 2022 - 122 and 1/8th, New York City'</span><span class="token punctuation">,</span>
  invitation<span class="token operator">:</span> <span class="token string">'You have been invited to the most awesome secret pizza party of the year!'</span><span class="token punctuation">,</span>
  question<span class="token operator">:</span> <span class="token string">'Are you coming?'</span><span class="token punctuation">,</span>
  answer1<span class="token operator">:</span> <span class="token string">'Cowabunga! (yes)'</span><span class="token punctuation">,</span>
  answer2<span class="token operator">:</span> <span class="token string">'Nitwits! (no)'</span><span class="token punctuation">,</span>
  secret_person<span class="token operator">:</span> <span class="token string">'Shredder'</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">Messages</span> <span class="token operator">=</span> <span class="token keyword">typeof</span> messages
<span class="token keyword">export</span> <span class="token keyword">default</span> messages</code></pre></div>
<p>The reason why we return these messages from the API (rather than embedding them in the frontend application code) is that this way these messages won‚Äôt be included in the JavaScript bundle. So, a user without an invite code won‚Äôt be able to extract potentially sensitive information from the JavaScript bundle of the frontend application.</p>
<h2 id="invite-validation-in-react" style="position:relative;"><a href="#invite-validation-in-react" aria-label="invite validation in react permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Invite validation in React</h2>
<p>Great!</p>
<p>At this point, we have a <em>mini-database</em> (if we want to call our AirTable table like that) and an API to get invite data.</p>
<p>We can finally start to work on the frontend!</p>
<p>The first thing that we can do is to build a <strong>custom React hook</strong> that can do the following:</p>
<ol>
<li>Grab the invite code from the current URL</li>
<li>Call the invite API using the invite code</li>
<li>Expose the returned invite data and the messages</li>
<li>Also, expose possible errors throughout the process</li>
</ol>
<p>I am going to go ahead and show you the code (<code>components/hooks/useInvite.tsx</code>), but if you want to review React docs on how to build custom hooks <a href="https://reactjs.org/docs/hooks-custom.html">here‚Äôs the page</a>.</p>
<p>Our custom hook will be using React‚Äôs built-in <a href="https://reactjs.org/docs/hooks-state.html"><code>useState</code></a> hook to handle state and <a href="https://reactjs.org/docs/hooks-effect.html"><code>useEffect</code></a> to run code on component mount.</p>
<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">import</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> InviteResponse <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../types/invite'</span>

<span class="token comment">// Defines the endpoint based on the current window location</span>
<span class="token keyword">const</span> <span class="token constant">API_BASE</span> <span class="token operator">=</span> <span class="token keyword">typeof</span> window <span class="token operator">!==</span> <span class="token string">'undefined'</span>
  <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>origin <span class="token operator">+</span> <span class="token string">'/api'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token constant">INVITE_ENDPOINT</span> <span class="token operator">=</span> <span class="token constant">API_BASE</span> <span class="token operator">+</span> <span class="token string">'/invite'</span>

<span class="token comment">// Helper function that uses fetch to invoke the invite API endpoint</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fetchInvite</span> <span class="token punctuation">(</span>code<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>InviteResponse<span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> requestUrl <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">URL</span></span><span class="token punctuation">(</span><span class="token constant">INVITE_ENDPOINT</span><span class="token punctuation">)</span>
  requestUrl<span class="token punctuation">.</span>searchParams<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'code'</span><span class="token punctuation">,</span> code<span class="token punctuation">)</span>
  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>requestUrl<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Invalid code'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> invite <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> invite
<span class="token punctuation">}</span>

<span class="token comment">// The custom hook</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">useInvite</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token punctuation">[</span>InviteResponse <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
  <span class="token comment">// This hook has the inviteResponse and a possilbe error as state.</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>
    inviteResponse<span class="token punctuation">,</span>
    setInviteResponse
  <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span>InviteResponse <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>error<span class="token punctuation">,</span> setError<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>

  <span class="token comment">// We want to make the API call when the component using the hook</span>
  <span class="token comment">// is mounted so we use the useEffect hook.</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token comment">// We read the code from the current window URL.</span>
    <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">URL</span></span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> code <span class="token operator">=</span> url<span class="token punctuation">.</span>searchParams<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'code'</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// If there is no code, we set an error message.</span>
      <span class="token function">setError</span><span class="token punctuation">(</span><span class="token string">'No code provided'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// If we have a code, we get the associated data.</span>
      <span class="token comment">// In case of success or failure we update the state accordingly.</span>
      <span class="token function">fetchInvite</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>setInviteResponse<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>err <span class="token operator">=></span> <span class="token punctuation">{</span>
          <span class="token function">setError</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token comment">// We return the state variables.</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>inviteResponse<span class="token punctuation">,</span> error<span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre></div>
<p>We can now import this hook into any component and use it like this:</p>
<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> useInvite <span class="token keyword">from</span> <span class="token string">'./hooks/useInvite'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">SomeExampleComponent</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>inviteResponse<span class="token punctuation">,</span> error<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useInvite</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment">// there was an error</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">... some error happened</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">}</span>

  <span class="token comment">// still loading the data from the backend</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>inviteResponse<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">Loading ...</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">}</span>

  <span class="token comment">// has the data!</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
    actual component markup when inviteResponse is available
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token punctuation">}</span></code></pre></div>
<p>Note how the hook nicely abstracts the data fetching operation, but we still need to keep into account that this operation will be asynchronous and we need to handle the 3 possible states: <em>loading</em>, success, and error.</p>
<p>The code above is very similar to the actual <code>Home</code> component in our application. There isn‚Äôt much value in showing the entire source code here once you understand the idea, but if you are curious you can find the full source in <a href="https://github.com/lmammino/secret-pizza-party/blob/main/components/Home.tsx"><code>components/Home.tsx</code></a>.</p>
<p>At this point, the only thing that is missing is to use the <code>Home</code> component in the single page that we are going to have in our Next.js application (it‚Äôs a Single Page Application after all).</p>
<p>In Next.js, page components are components inside the <code>page</code> directory. In our case we will only have the index page, so the component is <a href="https://github.com/lmammino/secret-pizza-party/blob/main/pages/index.tsx"><code>pages/index.tsx</code></a>.</p>
<p>Finally, if you run the application locally, you should have a loading screen and then a success error (with a valid invite code) or an error (if you didn‚Äôt provide a code or if you have an invalid one). üéâ</p>
<h2 id="collecting-user-data" style="position:relative;"><a href="#collecting-user-data" aria-label="collecting user data permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Collecting user data</h2>
<p>So far we have only been reading data from our Airtable table, but nothing is stopping us from also writing data into it!</p>
<p>For example, once a user reaches their invite page, they have an option to RSVP to the event. How are we going to store their answer?</p>
<p>The simplest idea that comes to mind is to add a new column to our table for the field ‚Äúcoming‚Äù:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 30.859375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAzElEQVQY032L6W6EMBCD8/5vCeFmyQXMlUyyWlqpP6r2kzWy7LFBxBBCSgkR7/sGgPM8U0rMDADOOe89EXnvY4rM/PIvH/xXa2qt27ZZa6dp6vt+GIbjOJZlrbUSUYyx1tpam+c5pdRau84ojK21krMhkmVZ+r4bx7HrOmvtvu/r+hkDQAhBVXPOzjkRKaoABamw1AvEMMsjFvm5RB8j8m2eh/wkAiiAVFSRxZRSVLU86AMR4R8Q0oUxF2mt5ZxN+cU/YyS60sXEqsrMb4qvWdW3R73kAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/099b44775ecee4a5b074d88eb209a7f9/8d3d1/airtable-option-field-coming.webp 256w,
/static/099b44775ecee4a5b074d88eb209a7f9/354cf/airtable-option-field-coming.webp 512w,
/static/099b44775ecee4a5b074d88eb209a7f9/44907/airtable-option-field-coming.webp 1024w,
/static/099b44775ecee4a5b074d88eb209a7f9/a8642/airtable-option-field-coming.webp 1536w,
/static/099b44775ecee4a5b074d88eb209a7f9/705b1/airtable-option-field-coming.webp 2048w,
/static/099b44775ecee4a5b074d88eb209a7f9/0b427/airtable-option-field-coming.webp 2188w"
              sizes="(max-width: 1024px) 100vw, 1024px"
              type="image/webp"
            />
          <source
            srcset="/static/099b44775ecee4a5b074d88eb209a7f9/85b06/airtable-option-field-coming.png 256w,
/static/099b44775ecee4a5b074d88eb209a7f9/bc282/airtable-option-field-coming.png 512w,
/static/099b44775ecee4a5b074d88eb209a7f9/f1720/airtable-option-field-coming.png 1024w,
/static/099b44775ecee4a5b074d88eb209a7f9/437a1/airtable-option-field-coming.png 1536w,
/static/099b44775ecee4a5b074d88eb209a7f9/7b24f/airtable-option-field-coming.png 2048w,
/static/099b44775ecee4a5b074d88eb209a7f9/ad2ba/airtable-option-field-coming.png 2188w"
            sizes="(max-width: 1024px) 100vw, 1024px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/099b44775ecee4a5b074d88eb209a7f9/f1720/airtable-option-field-coming.png"
            alt="Airtable option field to track whether guests are coming or not"
            title="Airtable option field to track whether guests are coming or not"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
    </span></p>
<p>The field we added is a <strong>single select</strong> type of field. We added two possible values: <strong>yes</strong> and <strong>no</strong>. In alternative we could have used a boolean field, but with this approach it we actually can manage 3 possible states for user RSVP:</p>
<ul>
<li><em>unknown</em> (the gues hasn‚Äôt submitted their RSVP yet)</li>
<li><em>coming</em> (‚Äúyes‚Äù)</li>
<li><em>not coming</em> (‚Äúno‚Äù)</li>
</ul>
<p>Now you know why we have originally defined a <code>coming</code> field (optional boolean) in our <code>Invite</code> interface and why we were popoluating it in our <code>utils/airtable.ts</code> helper file! üôÉ</p>
<p>In order to be allow our guests to submit their RSVP we need to do 4 main changes:</p>
<ol>
<li>Update the Airtable utility file with a function to update the <code>coming</code> field for a recod</li>
<li>Create a new API endpoint to collects RSVP (using the new utility function from point 1.)</li>
<li>Update our <code>useInvite</code> hook to provide functionality to submit the RSVP (and handle progress)</li>
<li>Update the frontend to use the new functionality provided by the <code>useInvite</code> hook</li>
</ol>
<p>We‚Äôll be doing some good amount of refactoring to introduce these changes, so let‚Äôs roll up our sleeves and warm up our keyboards!</p>
<h3 id="the-rsvp-airtable-utility" style="position:relative;"><a href="#the-rsvp-airtable-utility" aria-label="the rsvp airtable utility permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The RSVP Airtable utility</h3>
<p>In Airtable, every record in a table has a unique ID. If we know the ID we can use it to update one or more fields in that record.</p>
<p>In our application we have been using the invite code as unique ID and we already have some code written to be able to fetch a record by invite code.</p>
<p>It would be a good idea to refactor that code and extract the part that fetches a raw Airtable record. This way we can use this functionality in both our <em>retrieval</em> and <em>update</em> function (the latter which we still have to write).</p>
<p>So let‚Äôs open our file <code>utils/airtable.ts</code> again and add the following changes:</p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> Airtable<span class="token punctuation">,</span> <span class="token punctuation">{</span> FieldSet<span class="token punctuation">,</span> Record <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'airtable'</span>
<span class="token comment">// ...</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getInviteRecord</span> <span class="token punctuation">(</span>inviteCode<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Record<span class="token operator">&lt;</span>FieldSet<span class="token operator">>></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">base</span><span class="token punctuation">(</span><span class="token string">'invites'</span><span class="token punctuation">)</span>
      <span class="token comment">// runs a query on the `invites` table</span>
      <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        filterByFormula<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">{invite} = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">escape</span><span class="token punctuation">(</span>inviteCode<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        maxRecords<span class="token operator">:</span> <span class="token number">1</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token comment">// reads the first page of results</span>
      <span class="token punctuation">.</span><span class="token function">firstPage</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> records<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// propagate errors</span>
          <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
          <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// if the record could not be found</span>
        <span class="token comment">// we consider it an error</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>records <span class="token operator">||</span> records<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Invite not found'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// returns the first record</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span>records<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>You might have noticed that this function is almost identical to the <code>getInvite</code> function we wrote before, we are just returning the raw Airtable record, rather than mapping its data to an <code>Invite</code> object.</p>
<p>So it makes sense to avoid duplication and refactor our <code>getInvite</code>:</p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getInvite</span> <span class="token punctuation">(</span>inviteCode<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Invite<span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> inviteRecord <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getInviteRecord</span><span class="token punctuation">(</span>inviteCode<span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    code<span class="token operator">:</span> <span class="token function">String</span><span class="token punctuation">(</span>inviteRecord<span class="token punctuation">.</span>fields<span class="token punctuation">.</span>invite<span class="token punctuation">)</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token function">String</span><span class="token punctuation">(</span>inviteRecord<span class="token punctuation">.</span>fields<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span>
    favouriteColor<span class="token operator">:</span> <span class="token function">String</span><span class="token punctuation">(</span>inviteRecord<span class="token punctuation">.</span>fields<span class="token punctuation">.</span>favouriteColor<span class="token punctuation">)</span><span class="token punctuation">,</span>
    weapon<span class="token operator">:</span> <span class="token function">String</span><span class="token punctuation">(</span>inviteRecord<span class="token punctuation">.</span>fields<span class="token punctuation">.</span>weapon<span class="token punctuation">)</span><span class="token punctuation">,</span>
    coming<span class="token operator">:</span> <span class="token keyword">typeof</span> inviteRecord<span class="token punctuation">.</span>fields<span class="token punctuation">.</span>coming <span class="token operator">===</span> <span class="token string">'undefined'</span>
      <span class="token operator">?</span> <span class="token keyword">undefined</span>
      <span class="token operator">:</span> inviteRecord<span class="token punctuation">.</span>fields<span class="token punctuation">.</span>coming <span class="token operator">===</span> <span class="token string">'yes'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>The function is now an <code>async</code> function. It simply calls our new utility method and performs the mapping to an <code>Invite</code> object. Pretty simple, right?</p>
<p>Ok, now we can finally write the utility that allows us to update the <code>coming</code> field for a given record (by it‚Äôs invite code). Let‚Äôs call it <code>updateRsvp</code>:</p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">updateRsvp</span> <span class="token punctuation">(</span>inviteCode<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> rsvp<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token comment">// gets the raw Airtable id of the record to update</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> id <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getInviteRecord</span><span class="token punctuation">(</span>inviteCode<span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">base</span><span class="token punctuation">(</span><span class="token string">'invites'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token punctuation">{</span> coming<span class="token operator">:</span> rsvp <span class="token operator">?</span> <span class="token string">'yes'</span> <span class="token operator">:</span> <span class="token string">'no'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>

      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>One thing to remark here is that we are using the Airtable <code>update</code> method, which allows us to mutate a subset of fields (in our case only the <code>coming</code> field) and leave unchanged all the other fields. If you‚Äôll ever want to entirely replace a record, well, there‚Äôs a <code>replace</code> method for that!</p>
<h3 id="the-rsvp-endpoint" style="position:relative;"><a href="#the-rsvp-endpoint" aria-label="the rsvp endpoint permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The RSVP endpoint</h3>
<p>Now we can put our <code>updateRsvp</code> utility to good use and expose it through an API endpoint. To do that we can create a new API route by adding the file <code>pages/api/rsvp.ts</code>:</p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> NextApiRequest<span class="token punctuation">,</span> NextApiResponse <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'next'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> updateRsvp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../utils/airtable'</span>

<span class="token keyword">type</span> <span class="token class-name">RequestBody</span> <span class="token operator">=</span> <span class="token punctuation">{</span>coming<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">handler</span> <span class="token punctuation">(</span>
  req<span class="token operator">:</span> NextApiRequest<span class="token punctuation">,</span>
  res<span class="token operator">:</span> NextApiResponse<span class="token operator">&lt;</span><span class="token punctuation">{</span>updated<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">}</span> <span class="token operator">|</span> <span class="token punctuation">{</span> error<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token operator">></span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// if the request is not a PUT, return an error</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>method <span class="token operator">!==</span> <span class="token string">'PUT'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">405</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> error<span class="token operator">:</span> <span class="token string">'Method Not Allowed'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// if the code is missing we return a 400 error</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> error<span class="token operator">:</span> <span class="token string">'Missing invite code'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> reqBody <span class="token operator">=</span> req<span class="token punctuation">.</span>body <span class="token keyword">as</span> RequestBody

  <span class="token comment">// if the code is missing we return a 400 error</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> reqBody<span class="token punctuation">.</span>coming <span class="token operator">===</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> error<span class="token operator">:</span> <span class="token string">'Missing `coming` field in body'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// If there are multiple invite codes (?code=x&amp;code=y)</span>
  <span class="token comment">// we pick the first one and ignore the rest</span>
  <span class="token keyword">const</span> code <span class="token operator">=</span> <span class="token builtin">Array</span><span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>code<span class="token punctuation">)</span>
    <span class="token operator">?</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>code<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token operator">:</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>code

  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">updateRsvp</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> reqBody<span class="token punctuation">.</span>coming<span class="token punctuation">)</span>
    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> updated<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// In case of error we return either a 401 or a 500 error:</span>
    <span class="token comment">// - if the code was not found we return 401</span>
    <span class="token comment">// - otherwise we return a generic 500 server error</span>
    <span class="token keyword">const</span> e <span class="token operator">=</span> <span class="token punctuation">(</span>err <span class="token keyword">as</span> Error<span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>message <span class="token operator">===</span> <span class="token string">'Invite not found'</span> <span class="token operator">?</span> <span class="token number">401</span> <span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> error<span class="token operator">:</span> e<span class="token punctuation">.</span>message <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>A few things to note here:</p>
<ul>
<li>The API endpoint is now live at <code>http://localhost:3000/api/rsvp</code>.</li>
<li>This API receives 2 pieces of information: the invite code as a query string parameter and the <code>coming</code> field in the request body (encoded as a JSON object with just the <code>coming</code> field).</li>
<li>This API is a <code>PUT</code> endpoint. We are receiving some partial data to update a record so it makes sense to use PUT.</li>
<li>We are not being entirely <em>RESTful</em> (mostly for simplicity). If we wanted to be <em>RESTful</em> we should have created a <code>PUT</code> endpoint on the <code>/api/invite/{code}</code> path. This is possible in Next.js but it‚Äôs slightly more involved, so I went for a simpler solution (since this is a small pet project).</li>
</ul>
<h3 id="useinvite-hook-version-2" style="position:relative;"><a href="#useinvite-hook-version-2" aria-label="useinvite hook version 2 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>useInvite</code> hook version 2</h3>
<p>Ok, now that we have an API to update to submit an RSVP, we can update the <code>useInvite</code> hook to take advantage of this functionality. Be warned: we‚Äôll also be doing some decent amount of refactoring here‚Ä¶ Let‚Äôs update the <code>useInvite</code> code in <code>components/hooks/useInvite.tsx</code>:</p>
<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token comment">// ...</span>

<span class="token comment">// adds the URL of the new endpoint</span>
<span class="token keyword">const</span> <span class="token constant">RSVP_ENDPOINT</span> <span class="token operator">=</span> <span class="token constant">API_BASE</span> <span class="token operator">+</span> <span class="token string">'/rsvp'</span>

<span class="token comment">// type for the data returned by the hook</span>
<span class="token comment">// since we want to return 4 different pieces of information</span>
<span class="token comment">// it's better to organise them in an object, rather tha using</span>
<span class="token comment">// an array</span>
<span class="token keyword">interface</span> <span class="token class-name">HookResult</span> <span class="token punctuation">{</span>
  inviteResponse<span class="token operator">:</span> InviteResponse <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  error<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  updating<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span>
  <span class="token function-variable function">updateRsvp</span><span class="token operator">:</span> <span class="token punctuation">(</span>coming<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span>
<span class="token punctuation">}</span>

<span class="token comment">// ...</span>

<span class="token comment">// Helper function that invokes the rsvp API endpoint</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">updateRsvpRequest</span> <span class="token punctuation">(</span>code<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> coming<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> requestUrl <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">URL</span></span><span class="token punctuation">(</span><span class="token constant">RSVP_ENDPOINT</span><span class="token punctuation">)</span>
  requestUrl<span class="token punctuation">.</span>searchParams<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'code'</span><span class="token punctuation">,</span> code<span class="token punctuation">)</span>
  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>requestUrl<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    method<span class="token operator">:</span> <span class="token string">'PUT'</span><span class="token punctuation">,</span>
    headers<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    body<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> coming <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Failed to update RSVP'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">useInvite</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> HookResult <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>inviteResponse<span class="token punctuation">,</span> setInviteResponse<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span>InviteResponse <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>error<span class="token punctuation">,</span> setError<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
  <span class="token comment">// new state field to track when an RSVP update is in progress</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>updating<span class="token punctuation">,</span> setUpdating<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">URL</span></span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> code <span class="token operator">=</span> url<span class="token punctuation">.</span>searchParams<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'code'</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setError</span><span class="token punctuation">(</span><span class="token string">'No code provided'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">fetchInvite</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>setInviteResponse<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>err <span class="token operator">=></span> <span class="token punctuation">{</span>
          <span class="token function">setError</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token comment">// new hook function that exposes the ability to update the current invite by</span>
  <span class="token comment">// providing a value for the `coming` field</span>
  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">updateRsvp</span> <span class="token punctuation">(</span>coming<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>inviteResponse<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setUpdating</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
      <span class="token keyword">await</span> <span class="token function">updateRsvpRequest</span><span class="token punctuation">(</span>inviteResponse<span class="token punctuation">.</span>invite<span class="token punctuation">.</span>code<span class="token punctuation">,</span> coming<span class="token punctuation">)</span>
      <span class="token comment">// updates the current invite response, by cloning the original</span>
      <span class="token comment">// object and updating the `coming` property.</span>
      <span class="token function">setInviteResponse</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token operator">...</span>inviteResponse<span class="token punctuation">,</span>
        invite<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span>inviteResponse<span class="token punctuation">.</span>invite<span class="token punctuation">,</span> coming <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token function">setUpdating</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// We return the state variables and the updateRsvp function.</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> inviteResponse<span class="token punctuation">,</span> error<span class="token punctuation">,</span> updating<span class="token punctuation">,</span> updateRsvp <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Some code was omitted. You should have gotten an idea for the main changes, but feel free to check the full content of the file <a href="https://github.com/lmammino/secret-pizza-party/blob/main/components/hooks/useInvite.tsx">in the repository</a> in case you are following along and using this as an hands-on tutorial.</p>
<h3 id="using-the-updated-hook" style="position:relative;"><a href="#using-the-updated-hook" aria-label="using the updated hook permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using the updated hook</h3>
<p>I have mixed feelings when it comes to hooks and react. They are sometimes hard to use correctly because of the many rules around them, but to be honest, once you get the gist of them, they are pretty darn convenient.</p>
<p>In this case, our <code>useInvite</code> hook can deliver us a lot of value. In fact, it encapsulates all the business logic and lifecycle management to deal with loading and updating invites for the current user. When using this hook in a component, we don‚Äôt really have to worry too much about all of these concers: we can literally just access the data and decide when to trigger an update, the hook will handle everything else and trigger a re-render when necessary.</p>
<p>Let‚Äôs see how we can use the hook now. Again, there isn‚Äôt much point in showing all our actual code, so let‚Äôs observe a simplified example that illustrates the point (you can still <a href="https://github.com/lmammino/secret-pizza-party/blob/main/components/Home.tsx">see the complete file in the repository</a>).</p>
<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> ChangeEvent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> useInvite <span class="token keyword">from</span> <span class="token string">'./hooks/useInvite'</span>

<span class="token comment">// ...</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Home</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// We are now destructuring all the hook attributes and functions</span>
  <span class="token comment">//  - inviteResponse: the invite response (when available)</span>
  <span class="token comment">//  - error: an error message (if there was an error loading the data)</span>
  <span class="token comment">//  - updating: a boolean that will be true if an update is in progress</span>
  <span class="token comment">//  - updateRsvp: the function that allows us to update the current invite (coming or not)</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> inviteResponse<span class="token punctuation">,</span> error<span class="token punctuation">,</span> updating<span class="token punctuation">,</span> updateRsvp <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useInvite</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// There was an error loading the data</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">Duh! </span><span class="token punctuation">{</span>error<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>inviteResponse<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Still loading the invite data</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">Loading...</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Utility function to trigger an update when the user</span>
  <span class="token comment">// checks one of the radio buttons to RSVP</span>
  <span class="token keyword">function</span> <span class="token function">onRsvpChange</span> <span class="token punctuation">(</span>e<span class="token operator">:</span> ChangeEvent<span class="token operator">&lt;</span>HTMLInputElement<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> coming <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">'yes'</span>
    <span class="token function">updateRsvp</span><span class="token punctuation">(</span>coming<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Data loaded correctly: we can display the UI!</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fieldset</span> <span class="token attr-name">disabled</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>updating<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>legend</span><span class="token punctuation">></span></span><span class="token plain-text">Are you coming?</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>legend</span><span class="token punctuation">></span></span><span class="token plain-text">

        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">htmlFor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>yes<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> 
            <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span>
            <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>yes<span class="token punctuation">"</span></span>
            <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>coming<span class="token punctuation">"</span></span>
            <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>yes<span class="token punctuation">"</span></span>
            <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onRsvpChange<span class="token punctuation">}</span></span>
            <span class="token attr-name">checked</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>inviteResponse<span class="token punctuation">.</span>invite<span class="token punctuation">.</span>coming <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">}</span></span>
          <span class="token punctuation">/></span></span><span class="token plain-text">
          YES
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span><span class="token plain-text">

        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">htmlFor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>no<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
            <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span>
            <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>no<span class="token punctuation">"</span></span>
            <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>coming<span class="token punctuation">"</span></span>
            <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>no<span class="token punctuation">"</span></span>
            <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onRsvpChange<span class="token punctuation">}</span></span>
            <span class="token attr-name">checked</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>inviteResponse<span class="token punctuation">.</span>invite<span class="token punctuation">.</span>coming <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">}</span></span>
          <span class="token punctuation">/></span></span><span class="token plain-text">
          NO
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fieldset</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Note how the two <code>input</code> have an <code>onChange={onRsvpChange}</code> to actually trigger the change when the user checks one of the radio buttons. <code>onRsvpChange</code> will in turn invoke <code>updateRsvp</code> from the hook, using the value of the selected radio button (<code>"yes"</code> or <code>"no"</code> will turn into <code>true</code> or <code>false</code>).</p>
<p>We also control the input, by specifying <code>checked={inviteResponse.invite.coming === &#x3C;value>}</code>, so that the input updates accordingly when the data is actually changed by the <code>useInvite</code> hook.</p>
<h3 id="working-app" style="position:relative;"><a href="#working-app" aria-label="working app permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Working app</h3>
<p>At this point we should have a working application!</p>
<p>One thing that I really like about Airtable is that, when you are looking at a table in their web UI, if the underlying data changes, you‚Äôll see a flash that showcases the change.</p>
<p>This is a pretty great way to test how our application is actually changing the data in real-time:</p>
<p><img src="/content/60c16dec7b712c1f2b2406d890450c91/airtable-dynamic-table-update-example.gif" alt="Airtable dynamic table update animation"></p>
<p>Cool, isn‚Äôt it? üòé</p>
<h2 id="deploying-to-vercel" style="position:relative;"><a href="#deploying-to-vercel" aria-label="deploying to vercel permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deploying to Vercel</h2>
<p>Now we have a fully functional application. We are able to get users in only if they have a valid invite code and we can even register their RSVP.</p>
<p>But all of this is running on our local machine, so how do we put it online?</p>
<p>Next.js websites can be deployed in a number of places, but being a Vercel product, it should be no surprise the deploying on Vercel is the easiest option (at least for what I have tried).</p>
<p>This is roughly the list of steps that you should take to deploy on Vercel (from GitHub):</p>
<ul>
<li>Once you have all your code in a repository on GitHub, you can create an account on <a href="https://vercel.com/">Vercel</a> by logging in using GitHub.</li>
<li>At this point, you can create a new project (there‚Äôs a big button for that) and then select <strong>import Git Repository</strong>.</li>
<li>From that window you should see a list containing all your GitHub repositories.</li>
<li>Select the repository with your code and cick on <strong>import</strong>.</li>
<li>At this point Vercel will automatically build your code and deploy it, giving you a <strong>.vercel.app</strong> unique domain.</li>
<li>If you want, you can also customise the domain and provide a custom one!</li>
</ul>
<p>What happened behind the scens is that Vercel has deployed all your static assets (HTML, CSS, JavaScript, images,etc) to a CDN and all your API code to a serverless runtime that will be spawn up on demand when new requests arrive.</p>
<p>The best part is that, once you have done all of this and you have your website online, Vercel has already setup a simple but effective CI/CD workflow for you:</p>
<ul>
<li>Every time you deploy to your <code>main</code> branch, Vercel will automatically build and release the changes</li>
<li>If you deploy on another branch, Vercel will deploy and release the changes, but on a temporary URL that you can use to preview your changes.</li>
</ul>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 98.4375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAACv0lEQVQ4y32UyWoUQRjHq7uqv66tq6t6c3p6sjgjJhPJgkRFUGNcbooYHyDgK0ggL6AQMOTg0aMXBYkGYvTicslFMYiMUSEmwYv4FtpdGifi+DsUVXT/v70KNRqNJDJpmhpjhoaGOOeMsSiKAADthzEGAJRSu5owRFprAHAcByHkuu7e3unBPnt5ng8ODg4MDDSbzTRNrQz1gBAipUQIzczMzM7OIkop/w1jzPsvNmDP85IkKT21Wq32SHt4eGhkpN3f35ckcZYlSRJHFaaiPMex3WitoyhKkvhQcwDV60WeF7UDeb3eiKKEM+EDlUKaSrhnIurCGJNlWaMoUF9ffer8idNTk6emJs+cPXZm+vj0hZNHRg8zxoUQrAu/CwBfCIGuXLu4/e35u88rnZ21za/P3n1a2f3+cvHOvBDSGC2lDCs4592VcxyHc4YuXz3f+bK6sbW6cu/m3fnrG1urmztrC0tzQgRpmmqti6L4ZxcopaX4w/aTN5uPXr24u/Zw8fWH5Y+7TxeW5rgMpJSMsV5tK8WXrpx7v7W6vvHgdWf5zcfH62/vd7af3Lp9IwhCSn1CiOd5PcW1WjZ+dGRsoj02Pjw6Pjw20Z44euRgq58xJqUMgkAI4f+Lclp838cuwS4h2MOYuC52HFytf3BdF7u/cBwHAKxRJH8hpBRKhWGowlAppYIuys8VsgulFArD0PyGEFI62Y+LsQ+eENwOJgB4nkcqkDGmXq83Go2iKHzf/+vq2FDBI5xzAMAYE0IwxjYXxDnXWtswtNZCSsqYTSwMQ0ppVR1a+qlabS9IEptSLITQWiuljDFBEDDOfcYchABAKbVXW8/zrDc7qnktwxiXj0Ge52ma1mq1LM2U1jyQDiq7EMexEILzcsjtI+G6rk04inQptvf5jwcA8MGGJ6UEADsnhBArtr+lSfRT/AOuM3FjFqExWgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/17cc87928fc51e470b92573a828d9637/8d3d1/vercel-application-dashboard.webp 256w,
/static/17cc87928fc51e470b92573a828d9637/354cf/vercel-application-dashboard.webp 512w,
/static/17cc87928fc51e470b92573a828d9637/03f31/vercel-application-dashboard.webp 1000w"
              sizes="(max-width: 1000px) 100vw, 1000px"
              type="image/webp"
            />
          <source
            srcset="/static/17cc87928fc51e470b92573a828d9637/85b06/vercel-application-dashboard.png 256w,
/static/17cc87928fc51e470b92573a828d9637/bc282/vercel-application-dashboard.png 512w,
/static/17cc87928fc51e470b92573a828d9637/da8b6/vercel-application-dashboard.png 1000w"
            sizes="(max-width: 1000px) 100vw, 1000px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/17cc87928fc51e470b92573a828d9637/da8b6/vercel-application-dashboard.png"
            alt="Vercel Application dashboard"
            title="Vercel Application dashboard"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
    </span></p>
<p>That‚Äôs it! You can finally share your invite-only website will all your guests, and I am sure they are going to love it! üòú</p>
<h2 id="a-backend-less-alternative-approach" style="position:relative;"><a href="#a-backend-less-alternative-approach" aria-label="a backend less alternative approach permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>A backend-less alternative approach</h2>
<p>Before we wrap up, I want to give a quick mention to an idea I had while I was writing this post.</p>
<p>If we relax a bit our requirements removing the fact that we might want to collect user data (RSVP), there migth be a <em>‚Äúbackend-less‚Äù</em> alternative implementation.</p>
<p>Rather than using random invite codes, we could, in fact, use <a href="/whats-in-a-jwt">JSON Web Tokens</a>.</p>
<p>We could embed all the necessary information into the token paylos:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">‚ùØ jwtinfo <span class="token string">"eyJhbGciOiJFUzUxMiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiTGVvbmFyZG8iLCJmYXZvdXJpdGVDb2xvciI6ImJsdWUiLCJ3ZWFwb24iOiJUd2luIEthdGFuYSJ9.Ac69w5qHwnpzX3DZX4np-AZxcYcUA2D1aW64O2wB53v277MmamEuALJp6un2LTkYAeyciCz8eY6bRMNf9tq9e_KRAZcznffZf-vNUnzaWh9TgFhKuEdn2kI8B4d4NBP0TSW6iq-PLNVfwzldjilYA-QJRevcztSmcc-cEpZHukQdUHjy"</span> <span class="token operator">|</span> jq <span class="token builtin class-name">.</span>

<span class="token punctuation">{</span>
  <span class="token string">"favouriteColor"</span><span class="token builtin class-name">:</span> <span class="token string">"blue"</span>,
  <span class="token string">"name"</span><span class="token builtin class-name">:</span> <span class="token string">"Leonardo"</span>,
  <span class="token string">"weapon"</span><span class="token builtin class-name">:</span> <span class="token string">"Twin Katana"</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Yes, you should totally check out <a href="/learning-rust-through-open-source-and-live-code-reviews">the story of this cool <code>jwtinfo</code> command</a>!</p>
<p>The JWT signature should be generated using an asymmetric algorithm like <code>ES512</code>. At that point the frontend could embed the public key and use it to validate tokens and decide to show the information or not.</p>
<p>This would a be a very simple approach and it‚Äôs not free from flaws, for example:</p>
<ul>
<li>All the information needs to be embedded in the token</li>
<li>You won‚Äôt have a way to fetch private information from an API, so you are forced to put more stuff into the token or end up leaking sensitive information in your JavaScript bundle</li>
</ul>
<p>Still this simple approach might be good enough for simple websites that might be building for your friends and family!</p>
<p>Plus, you‚Äôd get to use JWT, which is a cool technology! üòú</p>
<p>As always, keep in mind that in technology there isn‚Äôt a perfect solution, just a different set of tradeoffs!</p>
<h2 id="conclusion" style="position:relative;"><a href="#conclusion" aria-label="conclusion permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Conclusion</h2>
<p>In this post we learned how to build an invite only Single Page Application using Next.js and Airtable as a data storage layer.</p>
<p>In the process we also saw how to create backend APIs with Next.js, how to create custom hook to simplify data fetching and update from the frontend and how to deploy our final creation to Vercel.</p>
<p>I am curious to know what you think about this approach and if you are thinking to use this for some personal or work projects.</p>
<p>Do let me know in the comments and, if you found this post valuable, consider <a href="https://twitter.com/loige">following me on Twitter</a> and sharing this article!</p>
<p>Thank you and see you in the next article! üëã</p></article><style data-emotion="css 1bhol7z">.css-1bhol7z{margin:2em 0;line-height:25px;padding:1em;font-size:small;border-radius:8px;background:rgba(255, 229, 100, 0.3);}.css-1bhol7z a{-webkit-text-decoration:none;text-decoration:none;border-bottom:2px solid #ffe564;color:inherit;}.css-1bhol7z a:hover{border-bottom:2px solid #ff9b51;}@media (min-width: 780px){.css-1bhol7z{padding:2em 2em;}}</style><div class="css-1bhol7z ep8980s0"><strong>Found a typo or something that can be improved?</strong><br/>In the spirit of Open Source, you can contribute to this article by<!-- --> <a href="https://github.com/lmammino/loige.co/blob/master/content/posts/2022-08-09_invite-only-microsites-with-nextjs-and-airtable/index.md" target="_blank" rel="noopener noreferrer">submitting a PR on <svg aria-label="GitHub" viewBox="0 0 24 24" width="1em" height="1em"><path fill="currentColor" d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg> GitHub</a></div><div style="border-top:1px solid #ececec;margin-top:2em;padding-top:2em;line-height:1.2" class="css-t2ycg8 ep8980s1"><h2 id="comments"><svg aria-hidden="true" data-prefix="fas" data-icon="comments" class="svg-inline--fa fa-comments fa-w-18" viewBox="0 0 576 512" width="1em" height="1em" style="margin:0 .25em 0 0"><path fill="currentColor" d="M416 192c0-88.4-93.1-160-208-160S0 103.6 0 192c0 34.3 14.1 65.9 38 92-13.4 30.2-35.5 54.2-35.8 54.5-2.2 2.3-2.8 5.7-1.5 8.7S4.8 352 8 352c36.6 0 66.9-12.3 88.7-25 32.2 15.7 70.3 25 111.3 25 114.9 0 208-71.6 208-160zm122 220c23.9-26 38-57.7 38-92 0-66.9-53.5-124.2-129.3-148.1.9 6.6 1.3 13.3 1.3 20.1 0 105.9-107.7 192-240 192-10.8 0-21.3-.8-31.7-1.9C207.8 439.6 281.8 480 368 480c41 0 79.1-9.2 111.3-25 21.8 12.7 52.1 25 88.7 25 3.2 0 6.1-1.9 7.3-4.8 1.3-2.9.7-6.3-1.5-8.7-.3-.3-22.4-24.2-35.8-54.5z"></path></svg> Comments</h2><div id="disqus_thread"></div></div></main><style data-emotion="css 1kp6918">.css-1kp6918{-webkit-flex:1;-ms-flex:1;flex:1;background:#f7f7f7;padding:1em;margin:0 0 2em 0;}.css-1kp6918 h3{margin:0 0 0.5em 0;position:relative;color:#111;}@media (min-width: 780px){.css-1kp6918{background:transparent;margin:0 0 1em 0;}.css-1kp6918>div{margin:1em 0 0 0;position:-webkit-sticky;position:sticky;overflow-y:auto;max-height:100vh;padding:0 0 3em 0;top:70px;}}</style><aside class="css-1kp6918 e1kc7zwr0"><style data-emotion="css 1jztyo0">.css-1jztyo0{background:#ffffcd;padding:0.5em;font-size:12px;display:block;color:inherit;-webkit-text-decoration:none;text-decoration:none;border:1px solid #ffffcd;margin:0 0 1em 0;}.css-1jztyo0:hover{border-color:#f89000;}</style><a href="https://www.nodejsdesignpatterns.com/" class="css-1jztyo0 e1pruv502"><style data-emotion="css jovua5">.css-jovua5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}</style><span class="css-jovua5 e1pruv501"><style data-emotion="css 1mvr8gq">.css-1mvr8gq{width:50%;padding:0 0 0 1em;display:block;}.css-1mvr8gq.left{max-width:125px;padding:0 0 0 1em!important;}@media (max-width: 1024px) and (min-width: 780px){.css-1mvr8gq{width:100%;max-width:auto!important;margin:0;}.css-1mvr8gq.left{padding:0 0 0 1em;}.css-1mvr8gq h4{padding:1em 0 0.5em 0!important;}}.css-1mvr8gq:first-of-type{padding:0;}.css-1mvr8gq h4{padding:0 0 0.5em 0;font-size:14px;}</style><span class="left css-1mvr8gq e1pruv500"><img src="/static/200-1cf8c01eb1b97df13cb6f6f3f36de3c0.jpg" style="width:100%" alt="Node.js Design Patterns Third Edition"/></span><span class="css-1mvr8gq e1pruv500"><h4>Node.js Design Patterns</h4><p>Design and implement production-grade <strong>Node.js</strong> <!-- -->applications using proven patterns and techniques with<!-- --> <em>Node.js Design Patterns Third Edition</em>. Available as<!-- --> <strong>Digital</strong> and <strong>Print</strong>.</p></span></span></a><div><style data-emotion="css exth3p">.css-exth3p ol{color:#6d6d6d;padding:0 0 0 2em;list-style:decimal-leading-zero;}.css-exth3p ol ol{padding:0 0 0 0.3em;}.css-exth3p ol li{font-size:0.8rem;font-family:source-code-pro,Menlo,Monaco,Consolas,Courier New,monospace;margin-top:5px;color:#111;}.css-exth3p ol li a{font-size:1.2em;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;color:#6d6d6d;border-bottom:1px solid transparent;-webkit-text-decoration:none;text-decoration:none;font-weight:bold;}.css-exth3p ol li a:hover{color:#000;outline-width:0;}.css-exth3p ol li.depth-3{font-size:0.8em;list-style:none;}</style><div class="css-exth3p eu4hp7r0"><h3>Sections</h3><ol><li class="depth-2"><a href="#the-use-case-and-the-tech-stack">The use case and the tech stack</a></li><li class="depth-2"><a href="#making-a-nextjs-site-private">Making a Next.js site private</a></li><li class="depth-2"><a href="#lets-build-an-invite-only-website">Let‚Äôs build an invite-only website!</a></li><li class="depth-2"><a href="#handling-sensitive-data-in-a-spa">Handling sensitive data in a SPA</a></li><li class="depth-2"><a href="#generating-and-storing-invite-codes">Generating and storing invite codes</a></li><li class="depth-2"><a href="#reading-invite-codes-using-the-airtable-sdk">Reading invite codes using the AirTable SDK</a></li><li class="depth-2"><a href="#nextjs-invite-endpoint">Next.js invite endpoint</a></li><li class="depth-2"><a href="#invite-validation-in-react">Invite validation in React</a></li><li class="depth-2"><a href="#collecting-user-data">Collecting user data</a><ol><li class="depth-3"><a href="#the-rsvp-airtable-utility">The RSVP Airtable utility</a></li><li class="depth-3"><a href="#the-rsvp-endpoint">The RSVP endpoint</a></li><li class="depth-3"><a href="#useinvite-hook-version-2">useInvite hook version 2</a></li><li class="depth-3"><a href="#using-the-updated-hook">Using the updated hook</a></li><li class="depth-3"><a href="#working-app">Working app</a></li></ol></li><li class="depth-2"><a href="#deploying-to-vercel">Deploying to Vercel</a></li><li class="depth-2"><a href="#a-backend-less-alternative-approach">A backend-less alternative approach</a></li><li class="depth-2"><a href="#conclusion">Conclusion</a></li></ol></div><h3 style="margin-top:1em">Share</h3><style data-emotion="css 125xt49">.css-125xt49{list-style:none;font-size:30px;padding:0.2em 0;}.css-125xt49 li{display:inline-block;margin:0 0.2em 0 0;}.css-125xt49 li a{color:#6d6d6d;}.css-125xt49 li a.twitter:hover{color:#00aced;}.css-125xt49 li a.facebook:hover{color:#3b5998;}.css-125xt49 li a.linkedin:hover{color:#007bb6;}.css-125xt49 li a.pinterest:hover{color:#cb2027;}.css-125xt49 li a.email:hover{color:black;}</style><ul class="css-125xt49 ey4v4xz0"><li><a rel="nofollow noopener noreferrer" class="twitter" target="_blank" href="https://twitter.com/intent/tweet?text=Invite-only%20microsites%20with%20Next.js%20and%20AirTable&amp;url=https%3A%2F%2Floige.co%2Finvite-only-microsites-with-nextjs-and-airtable%2F&amp;source=https%3A%2F%2Floige.co&amp;related=loige&amp;via=loige" title="Share via twitter"><svg aria-label="Twitter" viewBox="0 0 24 24" width="1em" height="1em"><path fill="currentColor" d="M23.954 4.569a10 10 0 0 1-2.825.775 4.958 4.958 0 0 0 2.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 0 0-8.384 4.482C7.691 8.094 4.066 6.13 1.64 3.161a4.822 4.822 0 0 0-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 0 1-2.228-.616v.061a4.923 4.923 0 0 0 3.946 4.827 4.996 4.996 0 0 1-2.212.085 4.937 4.937 0 0 0 4.604 3.417 9.868 9.868 0 0 1-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 0 0 7.557 2.209c9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63a9.936 9.936 0 0 0 2.46-2.548l-.047-.02z"></path></svg></a></li><li><a rel="nofollow noopener noreferrer" class="facebook" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Floige.co%2Finvite-only-microsites-with-nextjs-and-airtable%2F" title="Share via facebook"><svg aria-hidden="true" data-prefix="fab" data-icon="facebook-square" class="svg-inline--fa fa-facebook-square fa-w-14" viewBox="0 0 448 512" width="1em" height="1em"><path fill="currentColor" d="M448 80v352c0 26.5-21.5 48-48 48h-85.3V302.8h60.6l8.7-67.6h-69.3V192c0-19.6 5.4-32.9 33.5-32.9H384V98.7c-6.2-.8-27.4-2.7-52.2-2.7-51.6 0-87 31.5-87 89.4v49.9H184v67.6h60.9V480H48c-26.5 0-48-21.5-48-48V80c0-26.5 21.5-48 48-48h352c26.5 0 48 21.5 48 48z"></path></svg></a></li><li><a rel="nofollow noopener noreferrer" class="linkedin" target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Floige.co%2Finvite-only-microsites-with-nextjs-and-airtable%2F&amp;title=Invite-only%20microsites%20with%20Next.js%20and%20AirTable&amp;source=https%3A%2F%2Floige.co" title="Share via linkedin"><svg aria-hidden="true" data-prefix="fab" data-icon="linkedin-in" class="svg-inline--fa fa-linkedin-in fa-w-14" viewBox="0 0 448 512" width="1em" height="1em"><path fill="currentColor" d="M100.3 480H7.4V180.9h92.9V480zM53.8 140.1C24.1 140.1 0 115.5 0 85.8 0 56.1 24.1 32 53.8 32c29.7 0 53.8 24.1 53.8 53.8 0 29.7-24.1 54.3-53.8 54.3zM448 480h-92.7V334.4c0-34.7-.7-79.2-48.3-79.2-48.3 0-55.7 37.7-55.7 76.7V480h-92.8V180.9h89.1v40.8h1.3c12.4-23.5 42.7-48.3 87.9-48.3 94 0 111.3 61.9 111.3 142.3V480z"></path></svg></a></li><li><a rel="nofollow noopener noreferrer" class="pinterest" target="_blank" href="https://pinterest.com/pin/create/button/?media=https%3A%2F%2Floige.co%2Fstatic%2F1b3099eb0a746505ab3d3068302bf095%2Finvite-only-microsites-with-nextjs-and-airtable.jpg&amp;url=https%3A%2F%2Floige.co%2Finvite-only-microsites-with-nextjs-and-airtable%2F&amp;is_video=false&amp;description=Invite-only%20microsites%20with%20Next.js%20and%20AirTable" title="Share via pinterest"><svg aria-hidden="true" data-prefix="fab" data-icon="pinterest" class="svg-inline--fa fa-pinterest fa-w-16" viewBox="0 0 496 512" width="1em" height="1em"><path fill="currentColor" d="M496 256c0 137-111 248-248 248-25.6 0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8 0 128.7-68.8 128.7-154.3 0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1 0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3.8-3.4 5-20.3 6.9-28.1.6-2.5.3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6 0-54.7 41.4-107.6 112-107.6 60.9 0 103.6 41.5 103.6 100.9 0 67.1-33.9 113.6-78 113.6-24.3 0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6 0-19-10.2-34.9-31.4-34.9-24.9 0-44.9 25.7-44.9 60.2 0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9 0 361.1 0 256 0 119 111 8 248 8s248 111 248 248z"></path></svg></a></li><li><a rel="nofollow noopener noreferrer" class="email" target="_blank" href="/cdn-cgi/l/email-protection#7a455c1b170a4118151e03475f4a3b33140c130e1f57151416035f484a171319081509130e1f095f484a0d130e125f484a341f020e5410095f484a1b141e5f484a3b13082e1b18161f5f4a3b5f4a3b120e0e0a095f493b5f483c5f483c1615131d1f5419155f483c13140c130e1f571514160357171319081509130e1f09570d130e1257141f020e1009571b141e571b13080e1b18161f5f483c5c1b170a41090f18101f190e4733140c130e1f57151416035f484a171319081509130e1f095f484a0d130e125f484a341f020e5410095f484a1b141e5f484a3b13082e1b18161f" title="Share via email"><svg aria-hidden="true" data-prefix="far" data-icon="envelope" class="svg-inline--fa fa-envelope fa-w-16" viewBox="0 0 512 512" width="1em" height="1em"><path fill="currentColor" d="M464 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm0 48v40.805c-22.422 18.259-58.168 46.651-134.587 106.49-16.841 13.247-50.201 45.072-73.413 44.701-23.208.375-56.579-31.459-73.413-44.701C106.18 199.465 70.425 171.067 48 152.805V112h416zM48 400V214.398c22.914 18.251 55.409 43.862 104.938 82.646 21.857 17.205 60.134 55.186 103.062 54.955 42.717.231 80.509-37.199 103.053-54.947 49.528-38.783 82.032-64.401 104.947-82.653V400H48z"></path></svg></a></li></ul><h3 style="margin-top:1em">Similar posts</h3><style data-emotion="css 10s5qey">.css-10s5qey{color:#6d6d6d;list-style:outside;padding:0 0 3em 1.25em;}.css-10s5qey li{margin:0.75em 0 0 0;}.css-10s5qey li:first-of-type{margin-top:0;}.css-10s5qey a{color:#6d6d6d;-webkit-text-decoration:none;text-decoration:none;font-weight:bold;}.css-10s5qey a:hover{color:#000;}</style><ul class="css-10s5qey e1empo690"><li><a href="/create-resources-conditionally-with-cdk">Create resources conditionally with CDK</a></li><li><a href="/provision-ubuntu-ec2-with-cdk">Provision an Ubuntu-based EC2 instance with CDK</a></li><li><a href="/fastify-and-preact-for-quick-web-app-prototyping">Fastify and Preact for quick web app prototyping</a></li><li><a href="/emerging-javascript-pattern-multiple-return-values">Emerging JavaScript pattern: multiple return values</a></li><li><a href="/my-universal-javascript-web-applications-talk-at-codemotion-rome-2017">My Universal JavaScript Web Applications talk at Codemotion Rome 2017</a></li></ul></div></aside></div></section></div><style data-emotion="css 1ywtb7p">.css-1ywtb7p{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;list-style:none;padding:0;font-size:14px;min-height:260px;}@media (min-width: 780px){.css-1ywtb7p{-webkit-box-flex-wrap:nowrap;-webkit-flex-wrap:nowrap;-ms-flex-wrap:nowrap;flex-wrap:nowrap;font-size:16px;}}@media (min-width: 1024px){.css-1ywtb7p{height:300px;font-size:18px;}}</style><ul class="css-1ywtb7p e191jpam2"><style data-emotion="css 92w3s3">.css-92w3s3{width:100%;text-align:center;min-height:100%;background:black;-webkit-background-size:cover;background-size:cover;}.css-92w3s3 a{-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;background:rgba(0, 0, 0, 0.8);height:100%;-webkit-transition:background 0.5s ease;transition:background 0.5s ease;padding:1em;}.css-92w3s3 a:hover{background:rgba(0, 0, 0, 0.3);}.css-92w3s3 a h4{color:#fff;font-size:1.2em;}.css-92w3s3 a p{color:rgba(255, 255, 255, 0.8);font-size:0.8em;vertical-align:middle;line-height:1em;}.css-92w3s3 a p svg{vertical-align:text-bottom;}</style><li style="background-image:url(/static/884f8477b744f354ed1ae5e483b2901e/aws-solution-architect-professional-exam-notes-tips.jpg)" class="css-92w3s3 e191jpam1"><a rel="prev" href="/aws-solution-architect-professional-exam-notes-tips"><style data-emotion="css 16g7a2l">.css-16g7a2l{display:inline-block;padding:4px 10px 5px;text-transform:uppercase;font-size:0.8em;color:rgba(255, 255, 255, 0.8);}</style><span class="css-16g7a2l e191jpam0">Read this next</span><h4>AWS Solution Architect Professional exam, my notes and tips</h4><p><svg aria-hidden="true" data-prefix="far" data-icon="eye" class="svg-inline--fa fa-eye fa-w-18" viewBox="0 0 576 512" width="1em" height="1em"><path fill="currentColor" d="M569.354 231.631C512.97 135.949 407.81 72 288 72 168.14 72 63.004 135.994 6.646 231.631a47.999 47.999 0 0 0 0 48.739C63.031 376.051 168.19 440 288 440c119.86 0 224.996-63.994 281.354-159.631a47.997 47.997 0 0 0 0-48.738zM288 392c-102.556 0-192.091-54.701-240-136 44.157-74.933 123.677-127.27 216.162-135.007C273.958 131.078 280 144.83 280 160c0 30.928-25.072 56-56 56s-56-25.072-56-56l.001-.042C157.794 179.043 152 200.844 152 224c0 75.111 60.889 136 136 136s136-60.889 136-136c0-31.031-10.4-59.629-27.895-82.515C451.704 164.638 498.009 205.106 528 256c-47.908 81.299-137.444 136-240 136z"></path></svg> <!-- -->22<!-- --> minutes read</p></a></li></ul><style data-emotion="css 98dwl5">.css-98dwl5{background-color:#20232a;color:#ffffff;padding-top:30px;padding-bottom:50px;position:relative;}</style><footer class="css-98dwl5 ecf9mth10"><style data-emotion="css rxhh6g">.css-rxhh6g{position:absolute;width:100%;top:0;height:2px;display:block;transform-origin:left center 0px;-webkit-transform:scaleX(1);-moz-transform:scaleX(1);-ms-transform:scaleX(1);transform:scaleX(1);z-index:50;-webkit-transition:-webkit-transform 400ms ease 100ms;transition:transform 400ms ease 100ms;background:linear-gradient(90deg, #46c9e5, #d26ac2);}</style><span class="css-rxhh6g ecf9mth9"></span><style data-emotion="css 1tjci2f">.css-1tjci2f{padding-left:20px;padding-right:20px;max-width:1260px;margin-left:auto;margin-right:auto;}@media (min-width: 780px){.css-1tjci2f{width:90%;}}</style><div class="css-1tjci2f ecf9mth8"><style data-emotion="css y6mpu4">.css-y6mpu4{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}</style><div class="css-y6mpu4 ecf9mth7"><style data-emotion="css 17fog7c">.css-17fog7c{-webkit-flex:1 auto;-ms-flex:1 auto;flex:1 auto;margin-bottom:1em;padding-right:1em;width:100%;}@media (min-width: 780px){.css-17fog7c{width:auto;}}</style><div class="css-17fog7c ecf9mth5"><style data-emotion="css mhff0s">.css-mhff0s{color:#d26ac2;font-size:14px;font-weight:bold;line-height:3;text-transform:uppercase;letter-spacing:0.08em;}</style><div style="color:#46c9e5" class="css-mhff0s ecf9mth3">Loige.co</div><style data-emotion="css 15vbtor">.css-15vbtor{font-size:0.8em;padding:4px 0 0 0;color:#ccc;}.css-15vbtor a{color:inherit;font-weight:bold;-webkit-text-decoration:none;text-decoration:none;}.css-15vbtor a:hover{color:#46c9e5;-webkit-text-decoration:underline;text-decoration:underline;}</style><p class="css-15vbtor ecf9mth1">Copyright ¬© Luciano Mammino 2014-<!-- -->2022<!-- -->.</p><p class="css-15vbtor ecf9mth1">Built with<!-- --> <a rel="nofollow noopener noreferrer" target="_blank" href="https://www.gatsbyjs.org">Gatsby</a>, Coffee and a lot of <style data-emotion="css 12awzcx">.css-12awzcx{color:#d26ac2;}.css-12awzcx:hover{color:red;}</style><span class="css-12awzcx ecf9mth0">‚ù§Ô∏é</span>.</p><p class="css-15vbtor ecf9mth1">Loige logo designed by<!-- --> <a rel="nofollow noopener noreferrer" target="_blank" href="http://andreamangano.com">Andrea Mangano</a>.</p><p class="css-15vbtor ecf9mth1">Hosted on<!-- --> <a rel="nofollow noopener noreferrer" target="_blank" href="https://github.com/lmammino/loige.co">GitHub</a>, accelerated by<!-- --> <a rel="nofollow noopener noreferrer" target="_blank" href="https://www.cloudflare.com">Cloudflare</a>.</p><p class="css-15vbtor ecf9mth1">Theme inspired by<!-- --> <a rel="nofollow noopener noreferrer" target="_blank" href="https://reactjs.org/docs/">React documentation.</a></p><p class="css-15vbtor ecf9mth1">Icons by<!-- --> <a rel="nofollow noopener noreferrer" target="_blank" href="https://fontawesome.com/">Font Awesome</a>.</p></div><style data-emotion="css fhit9x">.css-fhit9x{-webkit-flex:1 auto;-ms-flex:1 auto;flex:1 auto;margin-bottom:1em;padding-right:1em;}</style><div class="css-fhit9x ecf9mth6"><style data-emotion="css dnp3pp">.css-dnp3pp{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}</style><div class="css-dnp3pp ecf9mth4"><div class="css-mhff0s ecf9mth3">Explore</div><style data-emotion="css 1ez8siy">.css-1ez8siy{color:inherit;line-height:2;-webkit-text-decoration:none;text-decoration:none;}.css-1ez8siy:hover{color:#46c9e5;}</style><a href="/" class="css-1ez8siy ecf9mth2">Blog</a><a href="/speaking" class="css-1ez8siy ecf9mth2">Speaking</a><a href="/about" class="css-1ez8siy ecf9mth2">About</a><a href="/comment-policy" class="css-1ez8siy ecf9mth2">Comment Policy</a></div></div><div class="css-fhit9x ecf9mth6"><div class="css-dnp3pp ecf9mth4"><div class="css-mhff0s ecf9mth3">My Projects</div><a target="_blank" rel="nofollow noopener noreferrer" href="https://www.nodejsdesignpatterns.com" class="css-1ez8siy ecf9mth2">Node.js Design Patterns</a><a target="_blank" rel="nofollow noopener noreferrer" href="https://awsbites.com" class="css-1ez8siy ecf9mth2">AWS Bites</a><a target="_blank" rel="nofollow noopener noreferrer" href="https://fullstackbulletin.com" class="css-1ez8siy ecf9mth2">FullStack Bulletin</a><a target="_blank" rel="nofollow noopener noreferrer" href="https://middy.js.org" class="css-1ez8siy ecf9mth2">Middy</a></div></div><div class="css-fhit9x ecf9mth6"><div class="css-dnp3pp ecf9mth4"><div class="css-mhff0s ecf9mth3">Follow me</div><a rel="nofollow noopener noreferrer" href="https://twitter.com/loige" class="css-1ez8siy ecf9mth2"><svg aria-label="Twitter" viewBox="0 0 24 24" width="1em" height="1em"><path fill="currentColor" d="M23.954 4.569a10 10 0 0 1-2.825.775 4.958 4.958 0 0 0 2.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 0 0-8.384 4.482C7.691 8.094 4.066 6.13 1.64 3.161a4.822 4.822 0 0 0-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 0 1-2.228-.616v.061a4.923 4.923 0 0 0 3.946 4.827 4.996 4.996 0 0 1-2.212.085 4.937 4.937 0 0 0 4.604 3.417 9.868 9.868 0 0 1-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 0 0 7.557 2.209c9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63a9.936 9.936 0 0 0 2.46-2.548l-.047-.02z"></path></svg> Twitter</a><a rel="nofollow noopener noreferrer" href="https://twitch.tv/loige" class="css-1ez8siy ecf9mth2"><svg aria-label="Twitch" viewBox="0 0 24 24" width="1em" height="1em"><path fill="currentColor" d="M.975 4.175v16.694h5.749V24h3.139l3.134-3.132h4.705l6.274-6.258V0H2.542zm3.658-2.09h17.252v11.479l-3.66 3.652h-5.751L9.34 20.343v-3.127H4.633z"></path><path fill="currentColor" d="M10.385 6.262h2.09v6.26h-2.09zM16.133 6.262h2.091v6.26h-2.091z"></path></svg> Twitch</a><a rel="nofollow noopener noreferrer" href="https://www.youtube.com/loige" class="css-1ez8siy ecf9mth2"><svg aria-label="Youtube" viewBox="0 0 24 24" width="1em" height="1em"><path fill="currentColor" d="M23.469 5.929l.03.196a3.043 3.043 0 0 0-2.068-2.112l-.021-.005c-1.871-.508-9.4-.508-9.4-.508s-7.51-.01-9.4.508A3.044 3.044 0 0 0 .527 6.104l-.005.021c-.699 3.651-.704 8.038.031 11.947l-.031-.198a3.043 3.043 0 0 0 2.068 2.112l.021.005c1.869.509 9.4.509 9.4.509s7.509 0 9.4-.509a3.043 3.043 0 0 0 2.084-2.096l.005-.021c.318-1.698.5-3.652.5-5.648l-.001-.221.001-.23c0-1.997-.182-3.951-.531-5.846zM9.608 15.651V8.358l6.266 3.652z"></path></svg> Youtube</a><a rel="nofollow noopener noreferrer" href="https://www.linkedin.com/in/lucianomammino" class="css-1ez8siy ecf9mth2"><svg aria-label="LinkedIn" viewBox="0 0 24 24" width="1em" height="1em"><path fill="currentColor" d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg> Linkedin</a><a rel="nofollow noopener noreferrer" href="https://github.com/lmammino" class="css-1ez8siy ecf9mth2"><svg aria-label="GitHub" viewBox="0 0 24 24" width="1em" height="1em"><path fill="currentColor" d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg> GitHub</a></div></div></div></div></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-47248506-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/invite-only-microsites-with-nextjs-and-airtable/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-e4ec0435b44fba9b8b39.js"],"app":["/app-514e309b4e51a67a0ada.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-4c9ab4251958cf3dbd2c.js"],"component---content-pages-about-js":["/component---content-pages-about-js-4633ff8e8e6a282a19b1.js"],"component---content-pages-comment-policy-js":["/component---content-pages-comment-policy-js-3c6a39721512017d8ec9.js"],"component---src-pages-404-js":["/component---src-pages-404-js-dc2b10ea69db3388f05e.js"],"component---src-templates-blog-index-js":["/component---src-templates-blog-index-js-53d33cfd3e02466e4117.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-37356b1e59c3cfadffb9.js"],"component---src-templates-blog-post-share-image-js":["/component---src-templates-blog-post-share-image-js-05c00175dfd3cda6599c.js"],"component---src-templates-speaking-index-js":["/component---src-templates-speaking-index-js-349882d9327e252c6aa7.js"],"component---src-templates-tag-index-js":["/component---src-templates-tag-index-js-3552ab9114277143e61a.js"]};/*]]>*/</script><script src="/polyfill-e4ec0435b44fba9b8b39.js" nomodule=""></script><script src="/component---src-templates-blog-post-js-37356b1e59c3cfadffb9.js" async=""></script><script src="/4d6423837748823c19bdd3076c1db680baba727b-30a9131768be883bb7a1.js" async=""></script><script src="/850935577dc6138b95e5bc3f6f1d9b06bd36398e-b459adf742dcd4c51b3c.js" async=""></script><script src="/ab670281d767243777119348a2b810446e7309bb-19b089964506eaf24367.js" async=""></script><script src="/app-514e309b4e51a67a0ada.js" async=""></script><script src="/framework-9d9eff57288a5d76d992.js" async=""></script><script src="/webpack-runtime-37ce8688ee417142fe08.js" async=""></script></body></html>